#!/usr/bin/env Rscript
#  0.get_table_parallel_mtx_rdp_silva.R
#  Copyright 2017- E. Ernestina Godoy Lozano (tinagodoy@gmail.com)
#
#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2 of the License, or
#  (at your option) any later version.
#
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#
#  You should have received a copy of the GNU General Public License
#  along with this program; if not, write to the Free Software
#  Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
#  MA 02110-1301, USA.
#
#####################################################################################
#### get reads_ranking.txt from parallel-meta results with MTX databases in setA ####
#####################################################################################

args = commandArgs(trailingOnly=TRUE)
directory_table=args[1]
directory_table2=args[2]

## Get name from the last taxonomic annotation
tabla_new<- read.delim("classification_mod.txt", header=F)
colnames(tabla_new)<- c("reads_id","score","classification")
tabla_new$last.class<- sapply(as.character(tabla_new$classification), function(x){strsplit(x, ";")[[1]][length(strsplit(x, ";")[[1]])]})

tabla_new$last.class<- as.character(tabla_new$last.class)
tabla_new$last.class[which(tabla_new$last.class=="Pectobacterium sp. carotovorum")]<- "Pectobacterium carotovorum"
tabla_new$last.class[which(tabla_new$last.class=="Actinobacillus parahaemolyticus")]<- "Actinobacillus"
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. OS3 95")]<- "Streptomyces"
tabla_new$last.class[which(tabla_new$last.class=="Chloroplast")]<- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Koribacteraceae")]<- "Coriobacteriaceae"
tabla_new$last.class[which(tabla_new$last.class=="Vibrio sp. 27")]<- "Vibrio"
tabla_new$last.class[which(tabla_new$last.class=="NS5")] <- "Flavobacteriaceae"
tabla_new$last.class[which(tabla_new$last.class=="Brenneria sp. MK09")] <- "Brenneria"
tabla_new$last.class[which(tabla_new$last.class=="OPB56")] <- "Chlorobi"
tabla_new$last.class[which(tabla_new$last.class=="Ellin515")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="SHA 20")] <- "Anaerolineae"
tabla_new$last.class[which(tabla_new$last.class=="Stigonema sp. UAM 342")] <- "Stigonema"
tabla_new$last.class[which(tabla_new$last.class=="RB25")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Pir4")] <- "Planctomycetaceae"
tabla_new$last.class[which(tabla_new$last.class=="OM60")] <- "Halieaceae"
tabla_new$last.class[which(tabla_new$last.class=="YS2")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Sva0725")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="SC I 84")] <- "Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Erwinia dispersa")] <- "Erwinia"
tabla_new$last.class[which(tabla_new$last.class=="Sporichthyaceae hgcI")] <- "Sporichthyaceae"
tabla_new$last.class[which(tabla_new$last.class=="RB41")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Bacillus amyloliquefaciens CAU-B946")] <- "Bacillus velezensis CAU B946"
tabla_new$last.class[which(tabla_new$last.class=="Methanobacterium sp. SWAN-1")] <- "Methanobacterium paludis"
tabla_new$last.class[which(tabla_new$last.class=="Salmonella enterica subsp. enterica serovar Gallinarum/pullorum str.")] <- "Salmonella enterica subsp. enterica serovar Gallinarum var. Pullorum str. 76059"
tabla_new$last.class[which(tabla_new$last.class=="Thiohalorhabdales")] <- "Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Spirobacillales")] <- "Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Piscirickettsiaceae endosymbionts")] <- "Piscirickettsiaceae"
tabla_new$last.class[which(tabla_new$last.class=="Pseudanabaenales")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="HTCC")] <- "Alteromonadales"
tabla_new$last.class[which(tabla_new$last.class=="HTCC2188")] <- "Alteromonadales"
tabla_new$last.class[which(tabla_new$last.class=="EC1113")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="DS 18")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Desulfotomaculum Desulfovirgula")] <- "Desulfotomaculum"
tabla_new$last.class[which(tabla_new$last.class=="TM1")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Pseudanabaenales")] <- "Synechococcales"
tabla_new$last.class[which(tabla_new$last.class=="Neisseria flava mucosa pharyngis")] <- "Neisseria pharyngis subsp. flava"
tabla_new$last.class[which(tabla_new$last.class=="Marinilabiaceae")] <- "Marinilabiliaceae"
tabla_new$last.class[which(tabla_new$last.class=="GIF9")] <- "Dehalococcoidia"
tabla_new$last.class[which(tabla_new$last.class=="Dehalobacter Syntrophob")] <- "Dehalobacter"
tabla_new$last.class[which(tabla_new$last.class=="CCU21")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="0319 7L14")] <- "Actinobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Candidatus Nostocoida")] <- "Planctomycetaceae"
tabla_new$last.class[which(tabla_new$last.class=="BD1 7")] <- "Spongiibacteraceae"
tabla_new$last.class[which(tabla_new$last.class=="VE39G03")] <- "Aeromonas"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria iii1 15")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="S24 7")] <- "Bacteroidales"
tabla_new$last.class[which(tabla_new$last.class=="Lineage I")] <- "Elusimicrobia"
tabla_new$last.class[which(tabla_new$last.class=="Kaistobacter")] <- "Sphingomonas"
tabla_new$last.class[which(tabla_new$last.class=="Ruminococcaceae Group")] <- "Ruminococcaceae"
tabla_new$last.class[which(tabla_new$last.class=="Halobacteriaceae Group")] <- "Halobacteriaceae"
tabla_new$last.class[which(tabla_new$last.class=="Chloracidobacteria")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="BPC102")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Verruco 5")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="Marinilabiaceae")] <- "Marinilabiliaceae"
tabla_new$last.class[which(tabla_new$last.class=="Trabulsiella farmeri")] <- "Trabulsiella"
tabla_new$last.class[which(tabla_new$last.class=="iii1 15")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="WS3")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Sediment 1")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="SBR1031")] <- "Anaerolineae"
tabla_new$last.class[which(tabla_new$last.class=="Thiohalorhabdales")] <- "Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="SubsectionI")] <- "Oscillatoriophycideae"
tabla_new$last.class[which(tabla_new$last.class=="Pedosphaerae")] <- "Pedosphaera"
tabla_new$last.class[which(tabla_new$last.class=="Cloacamonae")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="koll11")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Pirellulales")] <- "Planctomycetacia"
tabla_new$last.class[which(tabla_new$last.class=="TG3")] <- "Fibrobacteres"
tabla_new$last.class[which(tabla_new$last.class=="AB16")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia Shigella")] <- "Escherichia"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia-Shigella")] <- "Escherichia"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia-Shigella bacterium ZH-4")] <- "bacterium ZH-4"
tabla_new$last.class[which(tabla_new$last.class=="Acetothermia uncultured bacterium")] <- "uncultured Acetothermia bacterium"
tabla_new$last.class[which(tabla_new$last.class=="AEGEAN-169 marine group")] <- "Rhodospirillaceae"
tabla_new$last.class[which(tabla_new$last.class=="Hahella unidentified")] <- "Hahella"
tabla_new$last.class[which(tabla_new$last.class=="Sulfurimonas uncultured bacterium")] <- "Sulfurimonas"
tabla_new$last.class[which(tabla_new$last.class=="Helicobacter uncultured bacterium")] <- "Helicobacter"
tabla_new$last.class[which(tabla_new$last.class=="Candidatus Methylacidiphilum")] <- "Methylacidiphilum"
tabla_new$last.class[which(tabla_new$last.class=="Thioalkalimicrobium gamma proteobacterium ASL1")] <- "Thioalkalimicrobium"
tabla_new$last.class[which(tabla_new$last.class=="Prevotella 7")] <- "Prevotella"
tabla_new$last.class[which(tabla_new$last.class=="Roseiflexus hot springs metagenome")] <- "Roseiflexus"
tabla_new$last.class[which(tabla_new$last.class=="FamilyI")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Chloroflexus unidentified")] <- "Chloroflexus"
tabla_new$last.class[which(tabla_new$last.class=="Candidatus Atelocyanobacterium (UCYN-A)")] <- "cyanobacterium UCYN-A"
tabla_new$last.class[which(tabla_new$last.class=="Leptospirillum uncultured bacterium")] <- "Leptospirillum"
tabla_new$last.class[which(tabla_new$last.class=="Prevotella 1")] <- "Prevotella"
tabla_new$last.class[which(tabla_new$last.class=="SubsectionIV")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Desulfobacterium delta proteobacterium 8aA2")] <- "Desulfobacterium"
tabla_new$last.class[which(tabla_new$last.class=="Candidatus Liberibacter")] <- "Candidatus Liberobacter"
tabla_new$last.class[which(tabla_new$last.class=="[Cellvibrio] gilvus ATCC 13127")] <- "Cellulomonas gilvus ATCC 13127"
tabla_new$last.class[which(tabla_new$last.class=="Caldicellulosiruptor kristjanssonii 177R1B")] <- "Caldicellulosiruptor kristjanssonii"
tabla_new$last.class[which(tabla_new$last.class=="Ilumatobacter actinobacterium YM22-133")] <- "Ilumatobacter"
tabla_new$last.class[which(tabla_new$last.class=="marine group cyanobacterium UCYN-A")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Incertae Sedis")] <- "Lachnospiraceae"
tabla_new$last.class[which(tabla_new$last.class=="Thioalkalivibrio gamma proteobacterium ASL10")] <- "Thioalkalivibrio"
tabla_new$last.class[which(tabla_new$last.class=="unclassified Iamiaceae")] <- "Iamiaceae"
tabla_new$last.class[which(tabla_new$last.class=="unclassified Bifidobacteriaceae")] <- "Bifidobacteriaceae"
tabla_new$last.class[which(tabla_new$last.class=="Bacteria Outgroup")] <- "Archaea"
tabla_new$last.class[which(tabla_new$last.class=="Akkermansia_muciniphila")] <- "Akkermansia muciniphila"
tabla_new$last.class[which(tabla_new$last.class=="Acinetobacter_rhizosphaerae")] <- "Acinetobacter rhizosphaerae"
tabla_new$last.class[which(tabla_new$last.class=="Psychroflexus_torquis")] <- "Psychroflexus torquis"
tabla_new$last.class[which(tabla_new$last.class=="Prevotella_melaninogenica")] <- "Prevotella melaninogenica"
tabla_new$last.class[which(tabla_new$last.class=="Bacteroides_fragilis")] <- "Bacteroides fragilis"
tabla_new$last.class[which(tabla_new$last.class=="Acinetobacter_lwoffii")] <- "Acinetobacter lwoffii"
tabla_new$last.class[which(tabla_new$last.class=="Neisseria_cinerea")] <- "Neisseria cinerea"
tabla_new$last.class[which(tabla_new$last.class=="Candidatus_Methylacidiphilum_infernorum")] <- "Methylacidiphilum infernorum"
tabla_new$last.class[which(tabla_new$last.class=="BD7-3")] <- "Alphaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Bosea genosp.")] <- "Bosea"
tabla_new$last.class[which(tabla_new$last.class=="C111")] <- "Acidimicrobiales"
tabla_new$last.class[which(tabla_new$last.class=="Candidatus Methylacidiphilum infernorum")] <- "Methylacidiphilum"
tabla_new$last.class[which(tabla_new$last.class=="Dehalobacter Syntrophobotulus")] <- "Dehalobacter"
tabla_new$last.class[which(tabla_new$last.class=="Dehalobacter Desulfovirgula")] <- "Dehalobacter"
tabla_new$last.class[which(tabla_new$last.class=="Phormidiaceae")] <- "Oscillatoriales"
tabla_new$last.class[which(tabla_new$last.class=="[Weeksellaceae]")] <- "Flavobacteriales"
tabla_new$last.class[which(tabla_new$last.class=="Desulfotomaculum Desulfovirgula")] <- "Desulfotomaculum"
tabla_new$last.class[which(tabla_new$last.class=="SBla14")] <- "Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Anabaena cylindrica UTAD A212")] <- "Anabaena cylindrica"
tabla_new$last.class[which(tabla_new$last.class=="[Rhodothermales]")] <- "Rhodothermales"
tabla_new$last.class[which(tabla_new$last.class=="[Pedosphaerae]")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="[Lentisphaeria]")] <- "Lentisphaeria"
tabla_new$last.class[which(tabla_new$last.class=="[Leptospirae]")] <- "Spirochaetes"
tabla_new$last.class[which(tabla_new$last.class=="[Entotheonellales]")] <- "Deltaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="[Fimbriimonadales]")] <- "Fimbriimonadales"
tabla_new$last.class[which(tabla_new$last.class=="[Fimbriimonadia]")] <- "Fimbriimonadia"
tabla_new$last.class[which(tabla_new$last.class=="[Chthoniobacteraceae]")] <- "Chthoniobacteraceae"
tabla_new$last.class[which(tabla_new$last.class=="[Chthoniobacterales]")] <- "Chthoniobacterales"
tabla_new$last.class[which(tabla_new$last.class=="[Brevinematae]")] <- "Spirochaetes"
tabla_new$last.class[which(tabla_new$last.class=="[Balneolaceae]")] <- "Balneolaceae"
tabla_new$last.class[which(tabla_new$last.class=="[Amoebophilaceae]")] <- "Amoebophilaceae"
tabla_new$last.class[which(tabla_new$last.class=="[Acidaminobacteraceae]")] <- "Clostridiales"
tabla_new$last.class[which(tabla_new$last.class=="Dethiosulfovibrionaceae")] <- "Synergistales"
tabla_new$last.class[which(tabla_new$last.class=="Gemellales")] <- "Bacilli"
tabla_new$last.class[which(tabla_new$last.class=="Caldithrixaceae")] <- "Caldithrix"
tabla_new$last.class[which(tabla_new$last.class=="Caldithrixae")] <- "Caldithrix"
tabla_new$last.class[which(tabla_new$last.class=="Caldithrixales")] <- "Caldithrix"
tabla_new$last.class[which(tabla_new$last.class=="Anaerobrancaceae")] <- "Natranaerobiales"
tabla_new$last.class[which(tabla_new$last.class=="Anaerolinaceae")] <- "Anaerolineales"
tabla_new$last.class[which(tabla_new$last.class=="Thiobacterales")] <- "Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria-6")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Arctic96B-7")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="[Caldithrix]")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="NC10")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="OP9")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="PRR-12")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="TM6")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Verruco-5")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="12up")] <- "Rhodocyclaceae"
tabla_new$last.class[which(tabla_new$last.class=="7B-8")] <- "Sphingomonadales"
tabla_new$last.class[which(tabla_new$last.class=="Acidisoma sibirica")] <- "Acidisoma sibiricum"
tabla_new$last.class[which(tabla_new$last.class=="Acidopila rosea")] <- "Acidipila rosea"
tabla_new$last.class[which(tabla_new$last.class=="Acyrthosiphon pisum (pea aphid)")] <- "Acyrthosiphon pisum"
tabla_new$last.class[which(tabla_new$last.class=="Angiopteris lygodiifolia (turnip fern)")] <- "Angiopteris lygodiifolia"
tabla_new$last.class[which(tabla_new$last.class=="Apis mellifera (honey bee)")] <- "Apis mellifera"
tabla_new$last.class[which(tabla_new$last.class=="Aquamonas fontana")] <- "Curvibacter fontanus"
tabla_new$last.class[which(tabla_new$last.class=="bacterium GG53E")] <- "Klebsiella sp. GG53E"
tabla_new$last.class[which(tabla_new$last.class=="bacterium PG122E")] <- "Klebsiella sp. PG122E"
tabla_new$last.class[which(tabla_new$last.class=="bacterium PG132S")] <- "Enterobacter sp. PG132S"
tabla_new$last.class[which(tabla_new$last.class=="bacterium QZ80E")] <- "Enterobacter sp. QZ80E"
tabla_new$last.class[which(tabla_new$last.class=="bacterium SS82E")] <- "Klebsiella sp. SS82E"
tabla_new$last.class[which(tabla_new$last.class=="Brevibacillus sp. PDF 25")] <- "Brevibacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Burkholderia kururiensis subsp. kururiensis")] <- "Burkholderia kururiensis"
tabla_new$last.class[which(tabla_new$last.class=="Burkholderia sp. IMER-B1-33")] <- "Burkholderia sp."
tabla_new$last.class[which(tabla_new$last.class=="Burkholderia sp. STM 4206")] <- "Burkholderia sp."
tabla_new$last.class[which(tabla_new$last.class=="Cellulomonas sp. KOPRI80191")] <- "Cellulomonas sp."
tabla_new$last.class[which(tabla_new$last.class=="CF2")] <- "Proteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="[Clostridium] bifermentans")] <- "Clostridium bifermentans"
tabla_new$last.class[which(tabla_new$last.class=="[Clostridium] ghonii")] <- "Clostridium ghonii"
tabla_new$last.class[which(tabla_new$last.class=="[Clostridium] glycolicum")] <- "Clostridium glycolicum"
tabla_new$last.class[which(tabla_new$last.class=="[Clostridium] irregulare")] <- "Clostridium irregulare"
tabla_new$last.class[which(tabla_new$last.class=="[Clostridium] litorale")] <- "Clostridium litorale"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium maritimum")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium mesophilum")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium metallolevans")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium piliforme (Tyzzer's bacillus)")] <- "Clostridium piliforme"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium ruminantium")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="[Clostridium] sordellii")] <- "Paeniclostridium sordellii"
tabla_new$last.class[which(tabla_new$last.class=="Corynebacteriaceae (Coryneform bacteria)")] <- "Corynebacteriaceae"
tabla_new$last.class[which(tabla_new$last.class=="Cucumis sativus (cucumber)")] <- "Cucumis sativus"
tabla_new$last.class[which(tabla_new$last.class=="Cylindrospermosis")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Desulfotomaculum indicum")] <- "Desulfotomaculum"
tabla_new$last.class[which(tabla_new$last.class=="Desulfurivibrio alkaliphilus AHT2")] <- "Desulfurivibrio alkaliphilus"
tabla_new$last.class[which(tabla_new$last.class=="Dokdonella sp. LM 2-5")] <- "Dokdonella sp."
tabla_new$last.class[which(tabla_new$last.class=="Family Incertae Sedis")] <- "Cytophagia"
tabla_new$last.class[which(tabla_new$last.class=="Family XI Incertae Sedis")] <- "Clostridiales"
tabla_new$last.class[which(tabla_new$last.class=="Flavobacteriaceae bacterium DGP-25")] <- "Flavobacteriaceae"
tabla_new$last.class[which(tabla_new$last.class=="gamma proteobacterium NOR51-B")] <- "Luminiphilus syltensis NOR5-1B"
tabla_new$last.class[which(tabla_new$last.class=="GKS98 freshwater group")] <- "Alcaligenaceae"
tabla_new$last.class[which(tabla_new$last.class=="Glaciecola punicea DSM 14233 = ACAM 611")] <- "Glaciecola punicea"
tabla_new$last.class[which(tabla_new$last.class=="Granulosicoccus sp. Z271")] <- "Granulosicoccus sp."
tabla_new$last.class[which(tabla_new$last.class=="Hafnia-Obesumbacterium")] <- "Hafnia"
tabla_new$last.class[which(tabla_new$last.class=="Halocella cellulolsilytica")] <- "Halocella cellulosilytica"
tabla_new$last.class[which(tabla_new$last.class=="Helianthus annuus (common sunflower)")] <- "Helianthus annuus"
tabla_new$last.class[which(tabla_new$last.class=="Huperzia lucidula (shining club moss)")] <- "Huperzia lucidula"
tabla_new$last.class[which(tabla_new$last.class=="intranuclear bacterium of Bathymodiolus spp")] <- "Endozoicomonas"
tabla_new$last.class[which(tabla_new$last.class=="iodide-oxidizers")] <- "Alphaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Isoetes engelmannii (Engelmann's quillwort)")] <- "Isoetes engelmannii"
tabla_new$last.class[which(tabla_new$last.class=="Ketogulonigenium vulgarum WSH-001")] <- "Ketogulonigenium vulgarum"
tabla_new$last.class[which(tabla_new$last.class=="Lytechinus variegatus (green sea urchin)")] <- "Lytechinus variegatus"
tabla_new$last.class[which(tabla_new$last.class=="Magnetococcus sp. SS-1")] <- "Magnetococcus sp."
tabla_new$last.class[which(tabla_new$last.class=="Marinimicrobium sp. yn3")] <- "Marinimicrobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Marivita sp. CB 1101")] <- "Marivita sp."
tabla_new$last.class[which(tabla_new$last.class=="Mesorhizobium sp. CP3")] <- "Mesorhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Microbulbifer halotolerans")] <- "Microbulbifer halophilus"
tabla_new$last.class[which(tabla_new$last.class=="mitochondria")] <- "Eukaryota"
tabla_new$last.class[which(tabla_new$last.class=="MNG3")] <- "Alphaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Nannospalax galili (Upper Galilee mountains blind mole rat)")] <- "Nannospalax galili"
tabla_new$last.class[which(tabla_new$last.class=="Natranaerobiaceae bacterium Z1001")] <- "Natranaerobaculum magadiense"
tabla_new$last.class[which(tabla_new$last.class=="Nitrosococcus halophilus Nc4")] <- "Nitrosococcus halophilus"
tabla_new$last.class[which(tabla_new$last.class=="OCS116 clade")] <- "Alphaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Octadecabacter antarcticus 238")] <- "Octadecabacter antarcticus"
tabla_new$last.class[which(tabla_new$last.class=="OM60(NOR5) clade")] <- "Alteromonadaceae"
tabla_new$last.class[which(tabla_new$last.class=="Paenibacillus sp. 112T")] <- "Paenibacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Paenibacillus sp. 7188T")] <- "Paenibacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Paenibacillus sp. KOPRI80157")] <- "Paenibacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Paenibacillus sp. TW-1")] <- "Paenibacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Pantoea oleae")] <- "Erwinia oleae"
tabla_new$last.class[which(tabla_new$last.class=="Paracoccus sp. YXX-4")] <- "Paracoccus sp."
tabla_new$last.class[which(tabla_new$last.class=="PeM15")] <- "Actinobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Phaseolus acutifolius (tepary bean)")] <- "Phaseolus acutifolius"
tabla_new$last.class[which(tabla_new$last.class=="Photobacterium damselae subsp. piscicida (causative agent of fish")] <- "Photobacterium damselae subsp. piscicida"
tabla_new$last.class[which(tabla_new$last.class=="Pusillimonas terrae")] <- "Parapusillimonas granuli"
tabla_new$last.class[which(tabla_new$last.class=="Rhizobiales (rhizobacteria)")] <- "Rhizobiales"
tabla_new$last.class[which(tabla_new$last.class=="Rhodoligotropha projecta")] <- "Rhodoligotrophos appendicifer"
tabla_new$last.class[which(tabla_new$last.class=="Rhodopseudomonas pangongensis")] <- "Rhodopseudomonas parapalustris"
tabla_new$last.class[which(tabla_new$last.class=="Rhodovulum thermophilus")] <- "Jhaorihella thermophila"
tabla_new$last.class[which(tabla_new$last.class=="Ricinus communis (castor bean)")] <- "Ricinus communis"
tabla_new$last.class[which(tabla_new$last.class=="Roseobacter clade AS-21 lineage")] <- "Roseobacter"
tabla_new$last.class[which(tabla_new$last.class=="rumen bacterium NK3A76")] <- "Ruminococcus sp. NK3A76"
tabla_new$last.class[which(tabla_new$last.class=="rumen bacterium NK3D112")] <- "Erysipelotrichaceae bacterium NK3D112"
tabla_new$last.class[which(tabla_new$last.class=="Saccharopolyspora salina")] <- "Saccharopolyspora qijiaojingensis"
tabla_new$last.class[which(tabla_new$last.class=="Saccharopolyspora thermophilus")] <- "Saccharopolyspora thermophila"
tabla_new$last.class[which(tabla_new$last.class=="Saccharothrix sp. UTMC 537")] <- "Saccharothrix sp."
tabla_new$last.class[which(tabla_new$last.class=="Salinisphaera dokdoensis")] <- "Salinisphaera dokdonensis"
tabla_new$last.class[which(tabla_new$last.class=="Salmonella enterica subsp. enterica serovar Gallinarum/pullorum str")] <- "Salmonella enterica subsp. enterica serovar Gallinarum"
tabla_new$last.class[which(tabla_new$last.class=="SC-I-84")] <- "Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Sedimentibacter sp. MO-SED")] <- "Sedimentibacter sp."
tabla_new$last.class[which(tabla_new$last.class=="Shewanella marinus")] <- "Shewanella marina"
tabla_new$last.class[which(tabla_new$last.class=="Sitophilus zeamais (maize weevil)")] <- "Sitophilus zeamais"
tabla_new$last.class[which(tabla_new$last.class=="Solanum tuberosum (potato)")] <- "Solanum tuberosum"
tabla_new$last.class[which(tabla_new$last.class=="Sphaerochaeta globus str. Buddy")] <- "Sphaerochaeta globosa"
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. L180")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. TRM46012")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Thermoanerobacter brockii subsp. lactiethylicus")] <- "Thermoanerobacter brockii"
tabla_new$last.class[which(tabla_new$last.class=="Thermodesulfobacterium sp. OPB45")] <- "Thermodesulfobacterium sp."
tabla_new$last.class[which(tabla_new$last.class=="Thermomonas dokdonensis")] <- "Lysobacter dokdonensis"
tabla_new$last.class[which(tabla_new$last.class=="TM214")] <- "Acidimicrobiales"
tabla_new$last.class[which(tabla_new$last.class=="Alteromonas sp. S89")] <- "Alteromonas sp."
tabla_new$last.class[which(tabla_new$last.class=="Amphritea sp. MEBiC05461T")] <- "Amphritea sp."
tabla_new$last.class[which(tabla_new$last.class=="Amphritea sp.")] <- "Amphritea"
tabla_new$last.class[which(tabla_new$last.class=="Cellulosimicrobium ")] <- "Cellulosimicrobium"
tabla_new$last.class[which(tabla_new$last.class=="Dokdonella sp.")] <- "Dokdonella"
tabla_new$last.class[which(tabla_new$last.class=="Lactobacillus sp. 1.1424")] <- "Lactobacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Magnetococcus sp.")] <- "Magnetococcus"
tabla_new$last.class[which(tabla_new$last.class=="Marinimicrobium sp.")] <- "Marinimicrobium"
tabla_new$last.class[which(tabla_new$last.class=="Neptuniibacter ")] <- "Neptuniibacter"
tabla_new$last.class[which(tabla_new$last.class=="Pisum sativum (pea)")] <- "Pisum sativum"
tabla_new$last.class[which(tabla_new$last.class=="Thermoanerobacter brockii")] <- "Thermoanaerobacter"
tabla_new$last.class[which(tabla_new$last.class=="Tolumonas sp. OCF7")] <- "Tolumonas"
tabla_new$last.class[which(tabla_new$last.class=="Actinomyces sp. 2298/06")] <- "Actinomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Afipia felis (cat scratch disease bacillus)")] <- "Afipia felis"
tabla_new$last.class[which(tabla_new$last.class=="alphaI cluster")] <- "Rhizobiales"
tabla_new$last.class[which(tabla_new$last.class=="Arachis hypogaea (peanut)")] <- "Arachis hypogaea"
tabla_new$last.class[which(tabla_new$last.class=="Asplenium nidus (bird's-nest fern)")] <- "Asplenium nidus"
tabla_new$last.class[which(tabla_new$last.class=="bacterium LA14E")] <- "Enterobacter sp. LA14E"
tabla_new$last.class[which(tabla_new$last.class=="bacterium LA4E")] <- "Enterobacter sp. LA4E"
tabla_new$last.class[which(tabla_new$last.class=="Bifidobacterium pseudocatenulatum DSM 20438 = JCM 1200")] <- "Bifidobacterium pseudocatenulatum"
tabla_new$last.class[which(tabla_new$last.class=="Brasilonema bromeliae SPC 951")] <- "Brasilonema bromeliae"
tabla_new$last.class[which(tabla_new$last.class=="Brasilonema roberti-lammi str. los manantiales1")] <- "Brasilonema roberti-lamyi"
tabla_new$last.class[which(tabla_new$last.class=="Burkholderia sp. VUN10013")] <- "Burkholderia sp."
tabla_new$last.class[which(tabla_new$last.class=="Cryobacterium sp. MSL 15")] <- "Cryobacterium sp."
tabla_new$last.class[which(tabla_new$last.class=="DA023")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Danio rerio (zebrafish)")] <- "Danio rerio"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia albertii TW11588")] <- "Escherichia albertii"
tabla_new$last.class[which(tabla_new$last.class=="Francisella cantonensis")] <- "Allofrancisella guangzhouensis"
tabla_new$last.class[which(tabla_new$last.class=="Gluconobacter krungthepensis")] <- "Gluconobacter"
tabla_new$last.class[which(tabla_new$last.class=="Leptolyngbya sp. LEGE 07074")] <- "Leptolyngbya"
tabla_new$last.class[which(tabla_new$last.class=="Marmoricola sp. MSL 05")] <- "Marmoricola sp."
tabla_new$last.class[which(tabla_new$last.class=="Nostocaceae cyanobacterium SAG B11.82")] <- "Nostocaceae cyanobacterium"
tabla_new$last.class[which(tabla_new$last.class=="Pealius kelloggii (Kellogg's whitefly)")] <- "Pealius kelloggii"
tabla_new$last.class[which(tabla_new$last.class=="Phormidium sp. LEGE 07310")] <- "Phormidium sp."
tabla_new$last.class[which(tabla_new$last.class=="Phyllocladus trichomanoides (celery pine)")] <- "Phyllocladus trichomanoides"
tabla_new$last.class[which(tabla_new$last.class=="Quinella ovalis (Quin's oval)")] <- "Quinella ovalis"
tabla_new$last.class[which(tabla_new$last.class=="Sanguinaria canadensis (red puccoon)")] <- "Sanguinaria canadensis"
tabla_new$last.class[which(tabla_new$last.class=="SB1-18")] <- "Alphaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Serratia sp. WW4")] <- "Serratia sp."
tabla_new$last.class[which(tabla_new$last.class=="Shigella flexneri J1713")] <- "Shigella flexneri"
tabla_new$last.class[which(tabla_new$last.class=="Silene vulgaris (bladder campion)")] <- "Silene vulgaris"
tabla_new$last.class[which(tabla_new$last.class=="Sinorhizobium sp. AWS-3")] <- "Sinorhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Sinorhizobium sp. YZJ-1")] <- "Sinorhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Sorangium cellulosum 'So ce 56'")] <- "Sorangium cellulosum"
tabla_new$last.class[which(tabla_new$last.class=="Taenia solium (pork tapeworm)")] <- "Taenia solium"
tabla_new$last.class[which(tabla_new$last.class=="Tenacibaculum sp. CNURIC 013")] <- "Tenacibaculum sp."
tabla_new$last.class[which(tabla_new$last.class=="Thioalkalivibrio sp. ASLr1")] <- "Thioalkalivibrio sp."
tabla_new$last.class[which(tabla_new$last.class=="Vibrio parahaemolyticus 16")] <- "Vibrio parahaemolyticus"
tabla_new$last.class[which(tabla_new$last.class=="Xenopus (Silurana) tropicalis (western clawed frog)")] <- "Xenopus tropicalis"
tabla_new$last.class[which(tabla_new$last.class=="Nostocaceae cyanobacterium")] <- "Nostocaceae"
tabla_new$last.class[which(tabla_new$last.class=="Thioalkalivibrio sp.")] <- "Thioalkalivibrio"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria sp. N3B")] <- "Acidobacteria sp."
tabla_new$last.class[which(tabla_new$last.class=="Actinocatenispora silicis")] <- "Actinocatenispora rupis"
tabla_new$last.class[which(tabla_new$last.class=="Alloactinosynnema alba")] <- "Alloactinosynnema album"
tabla_new$last.class[which(tabla_new$last.class=="Angulomicrobium tetraedale")] <- "Angulomicrobium tetraedrale"
tabla_new$last.class[which(tabla_new$last.class=="Aquiflexum sp. LW9")] <- "Aquiflexum sp."
tabla_new$last.class[which(tabla_new$last.class=="bacterium GG49E")] <- "Enterobacter sp. GG49E"
tabla_new$last.class[which(tabla_new$last.class=="bacterium NN145S")] <- "Enterobacter sp. NN145S"
tabla_new$last.class[which(tabla_new$last.class=="Bifidobacterium coagulans")] <- "Bombiscardovia coagulans"
tabla_new$last.class[which(tabla_new$last.class=="Corynebacterium sp. 7015")] <- "Corynebacterium sp."
tabla_new$last.class[which(tabla_new$last.class=="Family III Incertae Sedis")] <- "Thermoanaerobacterales"
tabla_new$last.class[which(tabla_new$last.class=="Family XIII Incertae Sedis")] <- "Clostridiales"
tabla_new$last.class[which(tabla_new$last.class=="GOBB3-C201")] <- "Sphingomonadales"
tabla_new$last.class[which(tabla_new$last.class=="Gracilibacillus sp. YIM C229")] <- "Gracilibacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="'Jeotgalibacillus soli' Cunha et al. 2011")] <- "Jeotgalibacillus soli Cunha et al. 2012"
tabla_new$last.class[which(tabla_new$last.class=="Limnothrix planctonica CHAB709")] <- "Limnothrix planktonica CHAB709"
tabla_new$last.class[which(tabla_new$last.class=="Moraxella (Branhamella) caviae")] <- "Moraxella caviae"
tabla_new$last.class[which(tabla_new$last.class=="Ophioglossum vulgatum (southern adder's-tongue)")] <- "Ophioglossum vulgatum"
tabla_new$last.class[which(tabla_new$last.class=="Oryza sativa (rice)")] <- "Oryza sativa"
tabla_new$last.class[which(tabla_new$last.class=="Pullulanibacillus mentitum")] <- "Pullulanibacillus uraniitolerans"
tabla_new$last.class[which(tabla_new$last.class=="Rhodanobacter sp. IMER-B2-6")] <- "Rhodanobacter sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhodococcus sp. NIO-201101")] <- "Rhodococcus sp."
tabla_new$last.class[which(tabla_new$last.class=="Sphingomonas suberifaciens (corky root of lettuce)")] <- "Sphingomonas suberifaciens"
tabla_new$last.class[which(tabla_new$last.class=="TBZ33")] <- "Oceanospirillales"
tabla_new$last.class[which(tabla_new$last.class=="Thalassobius sp. EDB2")] <- "Thalassobius sp."
tabla_new$last.class[which(tabla_new$last.class=="Thalassobius sp. GSW-6")] <- "Thalassobius sp."
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria sp.")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Aquiflexum sp.")] <- "Aquiflexum"
tabla_new$last.class[which(tabla_new$last.class=="Thalassobius sp.")] <- "Thalassobius"
tabla_new$last.class[which(tabla_new$last.class=="Anabaena sphaerica UTEX 'B 1616'")] <- "Wollea ambigua SAG 1403-7"
tabla_new$last.class[which(tabla_new$last.class=="Anaerobaculum thermoterrnum")] <- "Acetomicrobium thermoterrenum"
tabla_new$last.class[which(tabla_new$last.class=="Bacteroidetes sp. BG31")] <- "Bacteroidetes bacterium BG31"
tabla_new$last.class[which(tabla_new$last.class=="Bogoriella caseolytica")] <- "Bogoriella caseilytica"
tabla_new$last.class[which(tabla_new$last.class=="Bradyrhizobium sp. STM609")] <- "Bradyrhizobium sp. STM 609"
tabla_new$last.class[which(tabla_new$last.class=="Caulobacter tundrae")] <- "Caulobacter sp. Z-0024"
tabla_new$last.class[which(tabla_new$last.class=="Cyanobium sp. LEGE 06322")] <- "Synechococcus cf. nidulans LEGE 06322"
tabla_new$last.class[which(tabla_new$last.class=="Ehrlichia ruminantium (heartwater rickettsia)")] <- "Ehrlichia ruminantium"
tabla_new$last.class[which(tabla_new$last.class=="Gluconacetobacter diazotrophicus PAl 5")] <- "Gluconacetobacter diazotrophicus PA1 5"
tabla_new$last.class[which(tabla_new$last.class=="Lens culinaris (lentil)")] <- "Lens culinaris"
tabla_new$last.class[which(tabla_new$last.class=="Marinomonas brasiliensis")] <- "Marinomonas brasilensis"
tabla_new$last.class[which(tabla_new$last.class=="Muricola jejuensis")] <- "Muriicola jejuensis"
tabla_new$last.class[which(tabla_new$last.class=="Nicotiana tabacum (common tobacco)")] <- "Nicotiana tabacum"
tabla_new$last.class[which(tabla_new$last.class=="Rickettsia akari (agent of rickettsialpox)")] <- "Rickettsia akari"
tabla_new$last.class[which(tabla_new$last.class=="Riemerella sp. R8091")] <- "Riemerella"
tabla_new$last.class[which(tabla_new$last.class=="alpha proteobacterium PII GH2.2.D12")]<- "alpha proteobacterium PII_GH2.2.D12"
tabla_new$last.class[which(tabla_new$last.class=="Alteromonas sp. M71 D56")]<- "Alteromonas sp. M71_D56"
tabla_new$last.class[which(tabla_new$last.class=="Asaia sp. SAP07 2")]<- "Asaia sp. SAP07_2"
tabla_new$last.class[which(tabla_new$last.class=="Bacillus sp. SK C-3")]<- "Bacillus sp. SK_C-3"
tabla_new$last.class[which(tabla_new$last.class=="bacterium enrichment culture DGGE band 61 6 F Ac")]<- "bacterium enrichment culture DGGE band 61_6_F_Ac"
tabla_new$last.class[which(tabla_new$last.class=="bacterium MPB LP d")]<- "bacterium MPB_LP_d"
tabla_new$last.class[which(tabla_new$last.class=="Bacteroidaceae bacterium DJF B220")]<- "Bacteroidaceae bacterium DJF_B220"
tabla_new$last.class[which(tabla_new$last.class=="Bacteroidetes sp. OM05")]<- "Bacteroidetes bacterium OM05"
tabla_new$last.class[which(tabla_new$last.class=="Bifidobacterium sp. DJF WC44")]<- "Bifidobacterium sp. DJF_WC44"
tabla_new$last.class[which(tabla_new$last.class=="cf. Leptolyngbya sp. Greenland 10")]<- "cf. Leptolyngbya sp. Greenland_10"
tabla_new$last.class[which(tabla_new$last.class=="Coprococcus sp. DJF CR49")]<- "Coprococcus sp. DJF_CR49"
tabla_new$last.class[which(tabla_new$last.class=="Enterobacteriaceae bacterium SL1 M11")]<- "Enterobacteriaceae bacterium SL1_M11"
tabla_new$last.class[which(tabla_new$last.class=="Enterobacter sp. NISOC 03")]<- "Enterobacter sp. NISOC_03"
tabla_new$last.class[which(tabla_new$last.class=="Enterobacter sp. RV E06 4c")]<- "Enterobacter sp. RV_E06_4c"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia coli STEC MHI813")]<- "Escherichia coli STEC_MHI813"
tabla_new$last.class[which(tabla_new$last.class=="Eubacteriaceae bacterium DJF CR57k1")]<- "Eubacteriaceae bacterium DJF_CR57k1"
tabla_new$last.class[which(tabla_new$last.class=="Flavobacterium sp. bk 54")]<- "Flavobacterium sp. bk_54"
tabla_new$last.class[which(tabla_new$last.class=="Geitlerinema sp. BBD P2b-1")]<- "Geitlerinema sp. BBD_P2b-1"
tabla_new$last.class[which(tabla_new$last.class=="Geobacillus thermoleovorans CCB US3 UF5")]<- "Geobacillus thermoleovorans CCB_US3_UF5"
tabla_new$last.class[which(tabla_new$last.class=="Geobacter chapelleii")]<- "Geobacter chapellei"
tabla_new$last.class[which(tabla_new$last.class=="hydrothermal vent eubacterium PVB OTU 5")]<- "hydrothermal vent eubacterium PVB_OTU_5"
tabla_new$last.class[which(tabla_new$last.class=="hydrothermal vent eubacterium PVB OTU 6")]<- "hydrothermal vent eubacterium PVB_OTU_6"
tabla_new$last.class[which(tabla_new$last.class=="Limnothrix planctonica CHAB753")]<- "Limnothrix planktonica CHAB753"
tabla_new$last.class[which(tabla_new$last.class=="Methylobacterium sp. OX1 1 1 S1")]<- "Methylobacterium sp. OX1_1_1_S1"
tabla_new$last.class[which(tabla_new$last.class=="Methylobacterium sp. SAP46 2")]<- "Methylobacterium sp. SAP46_2"
tabla_new$last.class[which(tabla_new$last.class=="Pantoea sp. SAP16 1")]<- "Pantoea sp. SAP16_1"
tabla_new$last.class[which(tabla_new$last.class=="Prevotellaceae bacterium DJF CR21k6")]<- "Prevotellaceae bacterium DJF_CR21k6"
tabla_new$last.class[which(tabla_new$last.class=="Prevotellaceae bacterium DJF CR25")]<- "Prevotellaceae bacterium DJF_CR25"
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium sp. MSAP L4")]<- "Rhizobium sp. MSAP_L4"
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium sp. MSAP L5")]<- "Rhizobium sp. MSAP_L5"
tabla_new$last.class[which(tabla_new$last.class=="Salinimonas sp. TB131 1")]<- "Salinimonas sp. TB131_1"
tabla_new$last.class[which(tabla_new$last.class=="Salinispora sp. UKMCC T112")]<- "Salinispora sp. UKMCC_T112"
tabla_new$last.class[which(tabla_new$last.class=="Shewanella sp. MFC 2")]<- "Shewanella sp. MFC_2"
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. CN207")]<- "Streptomyces tunisiensis"
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. CNS-730 SD06 MAR2")]<- "Streptomyces sp. CNS-730_SD06_MAR2"
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. L-2 19")]<- "Streptomyces sp. L-2_19"
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. UKMCC T109")]<- "Streptomyces sp. UKMCC_T109"
tabla_new$last.class[which(tabla_new$last.class=="Thioalkalivibrio sp. ALBR X2")]<- "Thioalkalivibrio sp. ALBR_X2"
tabla_new$last.class[which(tabla_new$last.class=="Thioalkalivibrio sp. ALBR X3")]<- "Thioalkalivibrio sp. ALBR_X3"
tabla_new$last.class[which(tabla_new$last.class=="Xanthomonadaceae bacterium SAP40 3")]<- "Xanthomonadaceae bacterium SAP40_3"
tabla_new$last.class[which(tabla_new$last.class=="Xenococcus sp. CR 15M")]<- "Xenococcus sp. CR_15M"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium venationis")]<- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Equisetum arvense (field horsetail)")]<- "Equisetum arvense"
tabla_new$last.class[which(tabla_new$last.class=="Marchantia polymorpha (liverwort)")]<- "Marchantia polymorpha"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp1")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp1_Gp1")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp3")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp3_Gp3")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp4")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp4_Gp4")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Bacillaceae 1")] <- "Bacillaceae"
tabla_new$last.class[which(tabla_new$last.class=="Bacillaceae 1 1")] <- "Bacillaceae"
tabla_new$last.class[which(tabla_new$last.class=="Burkholderiales_incertae_sedis_incertae_sedis")] <- "Burkholderiales"
tabla_new$last.class[which(tabla_new$last.class=="Clostridiaceae 1")] <- "Clostridiaceae"
tabla_new$last.class[which(tabla_new$last.class=="Clostridiaceae 1 1")] <- "Clostridiaceae"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium sensu stricto")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium XI")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium XlVa")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Cyanobacteria/Chloroplast")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia/Shigella")] <- "Escherichia"
tabla_new$last.class[which(tabla_new$last.class=="Family I")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Family IX")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp1")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp21")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp3")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp6")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpI")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpIIa")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpIIb")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpIV")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpIX")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpVI")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpVII")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpX")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpXI")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpXII")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpXIII")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Paenibacillaceae 1")] <- "Paenibacillaceae"
tabla_new$last.class[which(tabla_new$last.class=="Paenibacillaceae 1 1")] <- "Paenibacillaceae"
tabla_new$last.class[which(tabla_new$last.class=="Peptococcaceae 1")] <- "Peptococcaceae"
tabla_new$last.class[which(tabla_new$last.class=="Peptococcaceae 2 2")] <- "Peptococcaceae"
tabla_new$last.class[which(tabla_new$last.class=="Sporolactobacillaceae_incertae_sedis")] <- "Sporolactobacillaceae"
tabla_new$last.class[which(tabla_new$last.class=="subclass")] <- "Actinobacteria"
tabla_new$last.class[which(tabla_new$last.class=="suborder")] <- "Actinobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Unknown Metazoa")] <- "Eukaryota"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp10")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp12")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp13")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp14")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp15")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp16")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp17")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp20")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp21")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp6")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp9")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="BRC1")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpIII")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpV")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpVIII")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="OD1")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="OP10")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Subdivision3")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="Subdivision5")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="TM7")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp18")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp2")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp22")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp23")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp7")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp11")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="BRC1_genera_incertae_sedis")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Burkholderiales_incertae_sedis")] <- "Burkholderiales"
tabla_new$last.class[which(tabla_new$last.class=="Gp4")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp9")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Spartobacteria_genera_incertae_sedis")] <- "Spartobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Subdivision3_genera_incertae_sedis")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="Gp2")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp22")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp5")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp7")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="OP10_genera_incertae_sedis")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Subdivision5_genera_incertae_sedis")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="TM7_genera_incertae_sedis")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Corynebacterium bacterium EB288")] <- "bacterium EB288"
tabla_new$last.class[which(tabla_new$last.class=="FamilyI cyanobacterium IHB-347")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Kluyvera bacterium hswx111")] <- "bacterium hswx111"
tabla_new$last.class[which(tabla_new$last.class=="Mycobacterium actinomycete P048.UGM050509-01")] <- "actinomycete P048.UGM050509-01"
tabla_new$last.class[which(tabla_new$last.class=="Mycobacterium synthetic construct")] <- "Mycobacterium"
tabla_new$last.class[which(tabla_new$last.class=="Pantoea bacterium 1-5")] <- "bacterium 1-5"
tabla_new$last.class[which(tabla_new$last.class=="Pseudovibrio bacterium 2D803")] <- "bacterium 2D803"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium IV")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Aminicenantes_genera_incertae_sedis")] <- "Candidatus Aminicenantes"
tabla_new$last.class[which(tabla_new$last.class=="Archaea Outgroup")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Armatimonadetes_gp2")] <- "Armatimonadetes"
tabla_new$last.class[which(tabla_new$last.class=="Bacillaceae 2 2")] <- "Bacillaceae"
tabla_new$last.class[which(tabla_new$last.class=="Clostridiaceae 2 2")] <- "Clostridiaceae"
tabla_new$last.class[which(tabla_new$last.class=="Clostridiaceae 3 3")] <- "Clostridiaceae"
tabla_new$last.class[which(tabla_new$last.class=="Clostridiales_Incertae Sedis XI_Incertae Sedis XI")] <- "Clostridiales"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium XVIII")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Gammaproteobacteria_incertae_sedis_incertae_sedis")] <- "Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp10")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp13")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp15")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp17")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp18")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp25")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Lucibacterium")] <- "Vibrionaceae"
tabla_new$last.class[which(tabla_new$last.class=="Marinimicrobia_genera_incertae_sedis")] <- "Candidatus Marinimicrobia"
tabla_new$last.class[which(tabla_new$last.class=="Planococcaceae_incertae_sedis")] <- "Planococcaceae"
tabla_new$last.class[which(tabla_new$last.class=="Rhizobiales_incertae_sedis_incertae_sedis")] <- "Rhizobiales"
tabla_new$last.class[which(tabla_new$last.class=="Ruminococcus2")] <- "Ruminococcus"
tabla_new$last.class[which(tabla_new$last.class=="Saccharibacteria_genera_incertae_sedis")] <- "Candidatus Saccharibacteria"
tabla_new$last.class[which(tabla_new$last.class=="Subdivision33")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="WPS-1_genera_incertae_sedis")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="WPS-2_genera_incertae_sedis")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Armatimonadetes_gp5")] <- "Armatimonadetes"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium XII")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium XlVb")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Candidatus Brocadiaceae Brocadiaceae")] <- "Candidatus Brocadiaceae"
tabla_new$last.class[which(tabla_new$last.class=="Clostridiales_Incertae Sedis XIII_Incertae Sedis XIII")] <- "Clostridiales"
tabla_new$last.class[which(tabla_new$last.class=="Thermoactinomycetaceae 1 1")] <- "Thermoactinomycetaceae"

tabla_new2 <- data.frame(tabla_new$reads_id, tabla_new$classification, tabla_new$last.class, tabla_new$score)
write.table(tabla_new2,"otus_unicos_mod.txt", quote=F, col.names=T, row.names=F, sep="\t")
system(paste("python ", directory_table2, sep=""))

tabla<- read.delim("otus_unicos_taxid_mod.txt")
colnames(tabla)[2]<-"taxid"
tabla$taxid_limpio<- sapply(as.character(tabla$taxid), function(x){strsplit(strsplit(as.character(x), "[[]")[[1]][2], "[]]")[[1]][1]})
tabla$last_class_clean <- sapply(as.character(tabla$tabla_new.last.class), function(x){strsplit(x, " ")[[1]][1]})
dobles <- read.delim(directory_table, header=T)

lista <- c("[Bacillus]","[Pseudomonas]","[Clostridium]","[Haemophilus]", "[Eubacterium]", "[Streptomyces]", "[Bacteroides]", "[parainfluenzae]")
num2 <- which(tabla$last_class_clean%in%lista)
if(length(num2)>0){
	for (i in 1:length(num2)){
		num <- num2[i]
		taxid_sucio <- as.character(tabla$taxid[num])
		tabla$taxid_limpio[num] <- strsplit(strsplit(taxid_sucio, "[[]")[[1]][3], "[]]")[[1]][1]
	}
}

for (j in 1:dim(dobles)[1]){
	num <- which(tabla$last_class_clean==dobles$last_class[j])
	tabla$taxid_limpio[num] <-dobles$taxid[j]
}

new<- data.frame(tabla$tabla_new.reads_id, tabla$taxid_limpio, tabla$tabla_new.score)
write.table(new, "reads_ranking.txt", sep="\t", quote=F, col.names=F, row.names=F)
