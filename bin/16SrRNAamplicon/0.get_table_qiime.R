#!/usr/bin/env Rscript
#  0.get_table_qiime.R
#  Copyright 2017- E. Ernestina Godoy Lozano (tinagodoy@gmail.com)
#
#  This program is free software; you can redistribute it and/or modify
#  it under the terms of the GNU General Public License as published by
#  the Free Software Foundation; either version 2 of the License, or
#  (at your option) any later version.
#
#  This program is distributed in the hope that it will be useful,
#  but WITHOUT ANY WARRANTY; without even the implied warranty of
#  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
#  GNU General Public License for more details.
#
#  You should have received a copy of the GNU General Public License
#  along with this program; if not, write to the Free Software
#  Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston,
#  MA 02110-1301, USA.


##############################################################################
#### get reads_ranking.txt from QIIME results with GG, MTX, RDP databases ####
##############################################################################

args = commandArgs(trailingOnly=TRUE)
directory_table=args[1]
directory_table2=args[2]


tabla<- read.delim("classification_mod.txt", header=F)
colnames(tabla)<- c("reads_id","classification","score")
tabla$last.class<- sapply(as.character(tabla$classification), function(x){strsplit(x, ";")[[1]][length(strsplit(x, ";")[[1]])]})

nums <- grep("^[a-z]", tabla$last.class)
if (length(nums)>0){
	tabla$last.class[nums] <- sapply(as.character(tabla$classification[nums]), function(x){paste(strsplit(x, ";")[[1]][length(strsplit(x, ";")[[1]])-1],strsplit(x, ";")[[1]][length(strsplit(x, ";")[[1]])], sep=" ")})
}

tabla_new<- data.frame(reads_id=tabla$reads_id, classification=tabla$classification, last.class=tabla$last.class, score=tabla$score)
tabla_new$last.class<- as.character(tabla_new$last.class)

tabla_new$last.class[which(tabla_new$last.class=="vadinHA49 p04 C01")] <- "Planctomycetes"
tabla_new$last.class[which(tabla_new$last.class=="PRR-12 wb1 H11")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="MVS-104")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="MD2902-B50")] <- "Armatimonadetes"
tabla_new$last.class[which(tabla_new$last.class=="SHA-124")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Ulr1583")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="B12-WMSP1")] <- "Ktedonobacteria"
tabla_new$last.class[which(tabla_new$last.class=="A0-023")] <- "Brachyspirales"
tabla_new$last.class[which(tabla_new$last.class=="R76-B128")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="SC103")] <- "Thermotogaceae"
tabla_new$last.class[which(tabla_new$last.class=="02d06")] <- "Clostridiaceae"
tabla_new$last.class[which(tabla_new$last.class=="3BR-5F")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Ucs1325")] <- "Amoebophilaceae"
tabla_new$last.class[which(tabla_new$last.class=="JH-WHS99")] <- "Solibacteres"
tabla_new$last.class[which(tabla_new$last.class=="WS4")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Sharpea p-3329-23G2")] <- "Sharpea"
tabla_new$last.class[which(tabla_new$last.class=="OP3 koll11")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="OPB14")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="OR-59")] <- "Chthoniobacteraceae"
tabla_new$last.class[which(tabla_new$last.class=="Bulleidia hoa12 73A10")] <- "Bulleidia"
tabla_new$last.class[which(tabla_new$last.class=="YJF2-48")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="PK34")] <- "Solibacterales"
tabla_new$last.class[which(tabla_new$last.class=="S47")] <- "Anaerolineae"
tabla_new$last.class[which(tabla_new$last.class=="Ucm1571")] <- "Planctomycetes"
tabla_new$last.class[which(tabla_new$last.class=="AB16 noFP H7")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="JG37-AG-70")] <- "Nitrospiraceae"
tabla_new$last.class[which(tabla_new$last.class=="Hyd24-12")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="01D2Z36")] <- "Chthoniobacterales"
tabla_new$last.class[which(tabla_new$last.class=="01D2Z48")] <- "Chloroflexales"
tabla_new$last.class[which(tabla_new$last.class=="0319 7L14")] <- "Actinobacteria"
tabla_new$last.class[which(tabla_new$last.class=="0319-7L14")] <- "Actinobacteria"
tabla_new$last.class[which(tabla_new$last.class=="11-24")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="12up")] <- "Rhodocyclaceae"
tabla_new$last.class[which(tabla_new$last.class=="211ds20")] <- "Alteromonadales"
tabla_new$last.class[which(tabla_new$last.class=="34P16")] <- "Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="4-29")] <- "Nitrospirales"
tabla_new$last.class[which(tabla_new$last.class=="5-7N15")] <- "Bacteroidaceae"
tabla_new$last.class[which(tabla_new$last.class=="7B-8")] <- "Sphingomonadales"
tabla_new$last.class[which(tabla_new$last.class=="A1-B1")] <- "Gemmatimonadales"
tabla_new$last.class[which(tabla_new$last.class=="A21b")] <- "Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="A4b")] <- "Anaerolineae"
tabla_new$last.class[which(tabla_new$last.class=="AB16")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="AC1")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acetothermia uncultured bacterium")] <- "uncultured Acetothermia bacterium"
tabla_new$last.class[which(tabla_new$last.class=="[Acidaminobacteraceae]")] <- "Clostridiales"
tabla_new$last.class[which(tabla_new$last.class=="Acidimicrobiales wb1_P06")] <- "Acidimicrobiales"
tabla_new$last.class[which(tabla_new$last.class=="Acidisoma sibirica")] <- "Acidisoma sibiricum"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria-6")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria-6 iii1-15")] <- "Acidobacteriia"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp10")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp11")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp12")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp13")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp14")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp15")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp16")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp17")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp18")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp1")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp1_Gp1")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp20")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp21")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp22")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp23")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp2")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp3")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp3_Gp3")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp4")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp4_Gp4")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp6")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp7")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria_Gp9")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria iii1 15")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria sp.")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidobacteria sp. N3B")] <- "Acidobacteria bacterium N3B"
tabla_new$last.class[which(tabla_new$last.class=="Acidopila rosea")] <- "Acidipila rosea"
tabla_new$last.class[which(tabla_new$last.class=="[Aciduliprofundaceae]")] <- "Thermoplasmatales"
tabla_new$last.class[which(tabla_new$last.class=="Acinetobacter baumannii 1195185 80")] <- "Acinetobacter baumannii"
tabla_new$last.class[which(tabla_new$last.class=="Acinetobacter_lwoffii")] <- "Acinetobacter lwoffii"
tabla_new$last.class[which(tabla_new$last.class=="Acinetobacter_rhizosphaerae")] <- "Acinetobacter rhizosphaerae"
tabla_new$last.class[which(tabla_new$last.class=="ACK-M1")] <- "Actinomycetales"
tabla_new$last.class[which(tabla_new$last.class=="[Actinobacillus] muris")] <- "Actinobacillus muris"
tabla_new$last.class[which(tabla_new$last.class=="Actinobacillus parahaemolyticus")]<- "Actinobacillus"
tabla_new$last.class[which(tabla_new$last.class=="Actinobacteria bacterium P1 50 5AA1")] <- "Actinobacteria bacterium"
tabla_new$last.class[which(tabla_new$last.class=="Actinobacteria <class>")] <- "Actinobacteria"
tabla_new$last.class[which(tabla_new$last.class=="actinobacterium kmd 008")] <- "unclassified Actinobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Actinocatenispora silicis")] <- "Actinocatenispora rupis"
tabla_new$last.class[which(tabla_new$last.class=="Actinomyces sp. 2298/06")] <- "Actinomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Actinotelluria brasiliensis")] <- "Geodermatophilus brasiliensis"
tabla_new$last.class[which(tabla_new$last.class=="Acyrthosiphon pisum (pea aphid)")] <- "Acyrthosiphon pisum"
tabla_new$last.class[which(tabla_new$last.class=="AEGEAN-169 marine group")] <- "Rhodospirillaceae"
tabla_new$last.class[which(tabla_new$last.class=="Afipia felis (cat scratch disease bacillus)")] <- "Afipia felis"
tabla_new$last.class[which(tabla_new$last.class=="Agrobacterium sullae")] <- "Agrobacterium"
tabla_new$last.class[which(tabla_new$last.class=="AKIW659")] <- "Solibacterales"
tabla_new$last.class[which(tabla_new$last.class=="AKIW781")] <- "Chloroflexi"
tabla_new$last.class[which(tabla_new$last.class=="AKIW874")] <- "Acidimicrobiales"
tabla_new$last.class[which(tabla_new$last.class=="Akkermansia_muciniphila")] <- "Akkermansia muciniphila"
tabla_new$last.class[which(tabla_new$last.class=="Alloactinosynnema alba")] <- "Alloactinosynnema album"
tabla_new$last.class[which(tabla_new$last.class=="alphaI cluster")] <- "Rhizobiales"
tabla_new$last.class[which(tabla_new$last.class=="alpha proteobacterium F3H1 a8")] <- "unclassified Alphaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="alpha proteobacterium PII GH2.2.D12")]<- "alpha proteobacterium PII_GH2.2.D12"
tabla_new$last.class[which(tabla_new$last.class=="Alteromonas sp. M71 D56")]<- "Alteromonas sp. M71_D56"
tabla_new$last.class[which(tabla_new$last.class=="Alteromonas sp. NSA 9")] <- "Alteromonas sp."
tabla_new$last.class[which(tabla_new$last.class=="Alteromonas sp. S89")] <- "Alteromonas sp."
tabla_new$last.class[which(tabla_new$last.class=="[Amoebophilaceae]")] <- "Amoebophilaceae"
tabla_new$last.class[which(tabla_new$last.class=="Amphritea sp.")] <- "Amphritea"
tabla_new$last.class[which(tabla_new$last.class=="Amphritea sp. ")] <- "Amphritea"
tabla_new$last.class[which(tabla_new$last.class=="Amphritea sp. MEBiC05461T")] <- "Amphritea"
tabla_new$last.class[which(tabla_new$last.class=="Anabaena <cyanobacteria>")] <- "Anabaena"
tabla_new$last.class[which(tabla_new$last.class=="Anabaena cylindrica UTAD A212")] <- "Anabaena cylindrica"
tabla_new$last.class[which(tabla_new$last.class=="Anabaena doliolum Cy nb4")] <- "Anabaena doliolum"
tabla_new$last.class[which(tabla_new$last.class=="Anabaena sphaerica UTEX 'B 1616'")] <- "Wollea ambigua SAG 1403-7"
tabla_new$last.class[which(tabla_new$last.class=="Anaerobaculum thermoterrnum")] <- "Acetomicrobium thermoterrenum"
tabla_new$last.class[which(tabla_new$last.class=="Anaerobrancaceae")] <- "Natranaerobiales"
tabla_new$last.class[which(tabla_new$last.class=="Anaerolinaceae")] <- "Anaerolineaceae"
tabla_new$last.class[which(tabla_new$last.class=="Anaerolinaceae")] <- "Anaerolineales"
tabla_new$last.class[which(tabla_new$last.class=="Anaerolineae envOPS12")] <- "Anaerolineae"
tabla_new$last.class[which(tabla_new$last.class=="Ancylobacter sp. CRRI-104 SA2")] <- "Ancylobacter sp."
tabla_new$last.class[which(tabla_new$last.class=="Angiopteris lygodiifolia (turnip fern)")] <- "Angiopteris lygodiifolia"
tabla_new$last.class[which(tabla_new$last.class=="Angulomicrobium tetraedale")] <- "Angulomicrobium tetraedrale"
tabla_new$last.class[which(tabla_new$last.class=="Antarctic")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Apis mellifera (honey bee)")] <- "Apis mellifera"
tabla_new$last.class[which(tabla_new$last.class=="Aquamonas fontana")] <- "Curvibacter fontanus"
tabla_new$last.class[which(tabla_new$last.class=="Aquasalina")] <- "Aquisalimonas"
tabla_new$last.class[which(tabla_new$last.class=="Aquiflexum sp.")] <- "Aquiflexum"
tabla_new$last.class[which(tabla_new$last.class=="Aquiflexum sp. LW9")] <- "Cecembia lonarensis LW9"
tabla_new$last.class[which(tabla_new$last.class=="Arachis hypogaea (peanut)")] <- "Arachis hypogaea"
tabla_new$last.class[which(tabla_new$last.class=="Arctic96B-7")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Ardenscatenales")] <- "Anaerolineae"
tabla_new$last.class[which(tabla_new$last.class=="Asaia sp. SAP07 2")]<- "Asaia sp. SAP07_2"
tabla_new$last.class[which(tabla_new$last.class=="Asplenium nidus (bird's-nest fern)")] <- "Asplenium nidus"
tabla_new$last.class[which(tabla_new$last.class=="Azospirillum sp. enrichment culture clone MWE C43")] <- "Azospirillum sp."
tabla_new$last.class[which(tabla_new$last.class=="Azospirillum sp. enrichment culture clone Pn2 1.2")] <- "Azospirillum sp."
tabla_new$last.class[which(tabla_new$last.class=="B110")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="B-42")] <- "Trueperaceae"
tabla_new$last.class[which(tabla_new$last.class=="B97")] <- "Planctomycetia"
tabla_new$last.class[which(tabla_new$last.class=="BA021")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Bacillaceae 1 1")] <- "Bacillaceae"
tabla_new$last.class[which(tabla_new$last.class=="Bacillaceae 1")] <- "Bacillaceae"
tabla_new$last.class[which(tabla_new$last.class=="Bacillus amyloliquefaciens CAU-B946")] <- "Bacillus velezensis CAU B946"
tabla_new$last.class[which(tabla_new$last.class=="Bacillus <bacterium>")] <- "Bacillus"
tabla_new$last.class[which(tabla_new$last.class=="Bacillus sp. I GA W 9 10")] <- "Bacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Bacillus sp. II Gauze W 10 6")] <- "Bacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Bacillus sp. MUM116")] <- "Bacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Bacillus sp. SK C-3")]<- "Bacillus sp. SK_C-3"
tabla_new$last.class[which(tabla_new$last.class=="Bacillus sp. SRC DSF24")] <- "Bacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Bacillus sp. YU 2")] <- "Bacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Bacteria Outgroup")] <- "Archaea"
tabla_new$last.class[which(tabla_new$last.class=="Bacteria <prokaryotes>")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="bacterium AZD9 B1")] <- "unclassified Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="bacterium enrichment culture clone CBNH 1102 HA1 MIDDLE 2")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="bacterium enrichment culture clone heteroA1 4W")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="bacterium enrichment culture clone heteroB41 4W")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="bacterium enrichment culture clone Oil 13")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="bacterium enrichment culture clone Oil 76")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="bacterium enrichment culture DGGE band 61 6 F Ac")]<- "bacterium enrichment culture DGGE band 61_6_F_Ac"
tabla_new$last.class[which(tabla_new$last.class=="bacterium G 01")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="bacterium G 23")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="bacterium GG49E")] <- "Enterobacter sp. GG49E"
tabla_new$last.class[which(tabla_new$last.class=="bacterium GG53E")] <- "Klebsiella sp. GG53E"
tabla_new$last.class[which(tabla_new$last.class=="bacterium INBio 4099AF")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="bacterium KR 1979/121 50")] <- "unclassified Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="bacterium LA14E")] <- "Enterobacter sp. LA14E"
tabla_new$last.class[which(tabla_new$last.class=="bacterium LA4E")] <- "Enterobacter sp. LA4E"
tabla_new$last.class[which(tabla_new$last.class=="bacterium MPB LP d")]<- "bacterium MPB_LP_d"
tabla_new$last.class[which(tabla_new$last.class=="bacterium NN145S")] <- "Enterobacter sp. NN145S"
tabla_new$last.class[which(tabla_new$last.class=="bacterium PG122E")] <- "Klebsiella sp. PG122E"
tabla_new$last.class[which(tabla_new$last.class=="bacterium PG132S")] <- "Enterobacter sp. PG132S"
tabla_new$last.class[which(tabla_new$last.class=="bacterium QZ80E")] <- "Enterobacter sp. QZ80E"
tabla_new$last.class[which(tabla_new$last.class=="bacterium SS82E")] <- "Klebsiella sp. SS82E"
tabla_new$last.class[which(tabla_new$last.class=="Bacteroidaceae bacterium DJF B220")]<- "Bacteroidaceae bacterium DJF_B220"
tabla_new$last.class[which(tabla_new$last.class=="Bacteroides_fragilis")] <- "Bacteroides fragilis"
tabla_new$last.class[which(tabla_new$last.class=="Bacteroidetes <phylum>")] <- "Bacteroidetes"
tabla_new$last.class[which(tabla_new$last.class=="Bacteroidetes sp. BG31")] <- "Bacteroidetes bacterium BG31"
tabla_new$last.class[which(tabla_new$last.class=="Bacteroidetes sp. OM05")]<- "Bacteroidetes bacterium OM05"
tabla_new$last.class[which(tabla_new$last.class=="[Balneolaceae]")] <- "Balneolaceae"
tabla_new$last.class[which(tabla_new$last.class=="[Barnesiellaceae]")] <- "Barnesiellaceae"
tabla_new$last.class[which(tabla_new$last.class=="BD1 7")] <- "Spongiibacteraceae"
tabla_new$last.class[which(tabla_new$last.class=="BD2-13")] <- "Alteromonadaceae"
tabla_new$last.class[which(tabla_new$last.class=="BD4-9")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="BD7-3")] <- "Alphaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="beta proteobacterium PII GH1.2.B8")] <- "unclassified Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="BHI80-139 bOHTK-109")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Bifidobacterium coagulans")] <- "Bombiscardovia coagulans"
tabla_new$last.class[which(tabla_new$last.class=="Bifidobacterium pseudocatenulatum DSM 20438 = JCM 1200")] <- "Bifidobacterium pseudocatenulatum"
tabla_new$last.class[which(tabla_new$last.class=="Bifidobacterium sp. DJF WC44")]<- "Bifidobacterium sp. DJF_WC44"
tabla_new$last.class[which(tabla_new$last.class=="Bifidobacterium sp. LMM I9")] <- "Bifidobacterium sp."
tabla_new$last.class[which(tabla_new$last.class=="Bifidobacterium sp. MC 10")] <- "Bifidobacterium sp."
tabla_new$last.class[which(tabla_new$last.class=="Bifidobacterium sp. MC 8")] <- "Bifidobacterium sp."
tabla_new$last.class[which(tabla_new$last.class=="BME43")] <- "Bacteroidetes"
tabla_new$last.class[which(tabla_new$last.class=="Bogoriella caseolytica")] <- "Bogoriella caseilytica"
tabla_new$last.class[which(tabla_new$last.class=="Bosea genosp.")] <- "Bosea"
tabla_new$last.class[which(tabla_new$last.class=="BPC015")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="BPC102")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="[Brachyspirae]")] <- "Spirochaetes"
tabla_new$last.class[which(tabla_new$last.class=="Bradyrhizobium sp. enrichment culture clone MWE N32")] <- "Bradyrhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Bradyrhizobium sp. STM609")] <- "Bradyrhizobium sp. STM 609"
tabla_new$last.class[which(tabla_new$last.class=="Bradyrhizobium sp. SUTN2 3")] <- "Bradyrhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Brasilonema bromeliae SPC 951")] <- "Brasilonema bromeliae"
tabla_new$last.class[which(tabla_new$last.class=="Brasilonema roberti-lammi str. los manantiales1")] <- "Brasilonema roberti-lamyi"
tabla_new$last.class[which(tabla_new$last.class=="BRC1")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="BRC1_genera_incertae_sedis")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Brenneria sp. MK09")] <- "Brenneria"
tabla_new$last.class[which(tabla_new$last.class=="Brevibacillus sp. PDF 25")] <- "Brevibacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="[Brevinematae]")] <- "Spirochaetes"
tabla_new$last.class[which(tabla_new$last.class=="[Bryobacteraceae]")] <- "Bryobacteraceae"
tabla_new$last.class[which(tabla_new$last.class=="Bulleidia moorei")] <- "Solobacterium moorei"
tabla_new$last.class[which(tabla_new$last.class=="Burkholderia kururiensis subsp. kururiensis")] <- "Burkholderia kururiensis"
tabla_new$last.class[which(tabla_new$last.class=="Burkholderiales_incertae_sedis")] <- "Burkholderiales"
tabla_new$last.class[which(tabla_new$last.class=="Burkholderiales_incertae_sedis_incertae_sedis")] <- "Burkholderiales"
tabla_new$last.class[which(tabla_new$last.class=="Burkholderia sp. enrichment culture clone F20 07a B")] <- "Burkholderia sp."
tabla_new$last.class[which(tabla_new$last.class=="Burkholderia sp. IMER-B1-33")] <- "Burkholderia sp."
tabla_new$last.class[which(tabla_new$last.class=="Burkholderia sp. STM 4206")] <- "Burkholderia sp."
tabla_new$last.class[which(tabla_new$last.class=="Burkholderia sp. VUN10013")] <- "Burkholderia sp."
tabla_new$last.class[which(tabla_new$last.class=="C111")] <- "Acidimicrobiales"
tabla_new$last.class[which(tabla_new$last.class=="C39")] <- "Rhodocyclaceae"
tabla_new$last.class[which(tabla_new$last.class=="Caldicellulosiruptor kristjanssonii 177R1B")] <- "Caldicellulosiruptor kristjanssonii"
tabla_new$last.class[which(tabla_new$last.class=="Caldithrixaceae")] <- "Caldithrix"
tabla_new$last.class[which(tabla_new$last.class=="Caldithrixae")] <- "Caldithrix"
tabla_new$last.class[which(tabla_new$last.class=="Caldithrixales")] <- "Caldithrix"
tabla_new$last.class[which(tabla_new$last.class=="[Caldithrix]")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Candidatus Atelocyanobacterium (UCYN-A)")] <- "cyanobacterium UCYN-A"
tabla_new$last.class[which(tabla_new$last.class=="Candidatus")] <- "Candidatus Liberobacter"
tabla_new$last.class[which(tabla_new$last.class=="Candidatus Liberibacter")] <- "Candidatus Liberobacter"
tabla_new$last.class[which(tabla_new$last.class=="Candidatus Methylacidiphilum infernorum")] <- "Methylacidiphilum"
tabla_new$last.class[which(tabla_new$last.class=="Candidatus Methylacidiphilum infernorum")] <- "Methylacidiphilum infernorum"
tabla_new$last.class[which(tabla_new$last.class=="Candidatus_Methylacidiphilum_infernorum")] <- "Methylacidiphilum infernorum"
tabla_new$last.class[which(tabla_new$last.class=="Candidatus Methylacidiphilum")] <- "Methylacidiphilum"
tabla_new$last.class[which(tabla_new$last.class=="Candidatus Nostocoida")] <- "Planctomycetaceae"
tabla_new$last.class[which(tabla_new$last.class=="Caulobacter tundrae")] <- "Caulobacter sp. Z-0024"
tabla_new$last.class[which(tabla_new$last.class=="CCU21")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Cellulomonas sp. KOPRI80191")] <- "Cellulomonas sp."
tabla_new$last.class[which(tabla_new$last.class=="Cellulosimicrobium ")] <- "Cellulosimicrobium"
tabla_new$last.class[which(tabla_new$last.class=="[Cellvibrio] gilvus ATCC 13127")] <- "Cellulomonas gilvus ATCC 13127"
tabla_new$last.class[which(tabla_new$last.class=="[Cerasicoccaceae]")] <- "Opitutae"
tabla_new$last.class[which(tabla_new$last.class=="CF-26")] <- "Thiotrichaceae"
tabla_new$last.class[which(tabla_new$last.class=="CF2")] <- "Proteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="cf. Leptolyngbya sp. Greenland 10")]<- "cf. Leptolyngbya sp. Greenland_10"
tabla_new$last.class[which(tabla_new$last.class=="Chinabacter")] <- "Cytophagaceae"
tabla_new$last.class[which(tabla_new$last.class=="[Chloracidobacteria]")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Chloracidobacteria")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Chloroflexaceae bacterium enrichment culture clone ENRICH 116")] <- "Chloroflexaceae"
tabla_new$last.class[which(tabla_new$last.class=="Chloroflexaceae bacterium enrichment culture clone ENRICH SisoF2")] <- "Chloroflexaceae"
tabla_new$last.class[which(tabla_new$last.class=="Chloroflexi <phylum>")] <- "Chloroflexi"
tabla_new$last.class[which(tabla_new$last.class=="Chloroflexus unidentified")] <- "Chloroflexus"
tabla_new$last.class[which(tabla_new$last.class=="[Chloroherpetales]")] <- "Chlorobiales"
tabla_new$last.class[which(tabla_new$last.class=="Chloroplast")]<- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Chloroplast")] <- "Eukaryota"
tabla_new$last.class[which(tabla_new$last.class=="[Chlorothrixaceae]")] <- "Chloroflexales"
tabla_new$last.class[which(tabla_new$last.class=="[Chromatiaceae]")] <- "Chromatiaceae"
tabla_new$last.class[which(tabla_new$last.class=="Chromobacterium B 15")] <- "Chromobacterium"
tabla_new$last.class[which(tabla_new$last.class=="Chrysemys picta ")] <- "Chrysemys picta"
tabla_new$last.class[which(tabla_new$last.class=="[Chthoniobacteraceae]")] <- "Chthoniobacteraceae"
tabla_new$last.class[which(tabla_new$last.class=="[Chthoniobacterales]")] <- "Chthoniobacterales"
tabla_new$last.class[which(tabla_new$last.class=="[Chthoniobacterales] zEL20")] <- "Chthoniobacterales"
tabla_new$last.class[which(tabla_new$last.class=="Citrobacter sp. FDAARGOS 156")] <- "Citrobacter sp."
tabla_new$last.class[which(tabla_new$last.class=="CK-1C4-19")] <- "Tenericutes"
tabla_new$last.class[which(tabla_new$last.class=="Cloacamonae")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Clostridiaceae 1 1")] <- "Clostridiaceae"
tabla_new$last.class[which(tabla_new$last.class=="Clostridiaceae 1")] <- "Clostridiaceae"
tabla_new$last.class[which(tabla_new$last.class=="[Clostridium] bifermentans")] <- "Clostridium bifermentans"
tabla_new$last.class[which(tabla_new$last.class=="[Clostridium] ghonii")] <- "Clostridium ghonii"
tabla_new$last.class[which(tabla_new$last.class=="[Clostridium] glycolicum")] <- "Clostridium glycolicum"
tabla_new$last.class[which(tabla_new$last.class=="[Clostridium] irregulare")] <- "Clostridium irregulare"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium IV")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="[Clostridium] litorale")] <- "Clostridium litorale"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium maritimum")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium mesophilum")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium metallolevans")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium piliforme (Tyzzer's bacillus)")] <- "Clostridium piliforme"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium ruminantium")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium sensu stricto")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="[Clostridium] sordellii")] <- "Paeniclostridium sordellii"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium venationis")]<- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium XI")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Clostridium XlVa")] <- "Clostridium"
tabla_new$last.class[which(tabla_new$last.class=="Coprococcus sp. DJF CR49")]<- "Coprococcus sp. DJF_CR49"
tabla_new$last.class[which(tabla_new$last.class=="Corynebacteriaceae (Coryneform bacteria)")] <- "Corynebacteriaceae"
tabla_new$last.class[which(tabla_new$last.class=="Corynebacterium sp. 7015")] <- "Corynebacterium sp."
tabla_new$last.class[which(tabla_new$last.class=="Coxiella <Bacteria>")] <- "Coxiella"
tabla_new$last.class[which(tabla_new$last.class=="Cryobacterium sp. MSL 15")] <- "Cryobacterium sp."
tabla_new$last.class[which(tabla_new$last.class=="Cucumis sativus (cucumber)")] <- "Cucumis sativus"
tabla_new$last.class[which(tabla_new$last.class=="Cyanobacteria/Chloroplast/Chloroplast")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Cyanobacteria/Chloroplast")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Cyanobacterium sp. PCC 7502")] <- "Cyanobacterium"
tabla_new$last.class[which(tabla_new$last.class=="Cyanobium sp. LEGE 06322")] <- "Synechococcus cf. nidulans LEGE 06322"
tabla_new$last.class[which(tabla_new$last.class=="Cylindrospermosis")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="DA023")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Danio rerio (zebrafish)")] <- "Danio rerio"
tabla_new$last.class[which(tabla_new$last.class=="Dehalobacter Desulfovirgula")] <- "Dehalobacter"
tabla_new$last.class[which(tabla_new$last.class=="Dehalobacter Syntrophob")] <- "Dehalobacter"
tabla_new$last.class[which(tabla_new$last.class=="Dehalobacter Syntrophobotulus")] <- "Dehalobacter"
tabla_new$last.class[which(tabla_new$last.class=="Dehalobacter_Syntrophobotulus")] <- "Dehalobacter"
tabla_new$last.class[which(tabla_new$last.class=="Dehalococcoides sp. JN18 A96 B*")] <- "Dehalococcoides sp."
tabla_new$last.class[which(tabla_new$last.class=="Desulfitobacter")] <- "Desulfitibacter"
tabla_new$last.class[which(tabla_new$last.class=="Desulfobacterium delta proteobacterium 8aA2")] <- "Desulfobacterium"
tabla_new$last.class[which(tabla_new$last.class=="Desulfotomaculum Desulfovirgula")] <- "Desulfotomaculum"
tabla_new$last.class[which(tabla_new$last.class=="Desulfotomaculum_Desulfovirgula")] <- "Desulfotomaculum"
tabla_new$last.class[which(tabla_new$last.class=="Desulfotomaculum indicum")] <- "Desulfotomaculum"
tabla_new$last.class[which(tabla_new$last.class=="Desulfurivibrio alkaliphilus AHT2")] <- "Desulfurivibrio alkaliphilus"
tabla_new$last.class[which(tabla_new$last.class=="Dethiosulfovibrionaceae")] <- "Synergistales"
tabla_new$last.class[which(tabla_new$last.class=="Dok59")] <- "Rhodocyclaceae"
tabla_new$last.class[which(tabla_new$last.class=="Dokdonella sp.")] <- "Dokdonella"
tabla_new$last.class[which(tabla_new$last.class=="Dokdonella sp. LM 2-5")] <- "Dokdonella immobilis"
tabla_new$last.class[which(tabla_new$last.class=="DS 18")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="DS-18")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="EB1003")] <- "Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="EB1017")] <- "Acidimicrobiales"
tabla_new$last.class[which(tabla_new$last.class=="EC1113")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Edaphobacter modestum")] <- "Edaphobacter modestus"
tabla_new$last.class[which(tabla_new$last.class=="Edwardsiella <enterobacteria>")] <- "Edwardsiella"
tabla_new$last.class[which(tabla_new$last.class=="Ehrlichia ruminantium ")] <- "Ehrlichia ruminantium"
tabla_new$last.class[which(tabla_new$last.class=="Ehrlichia ruminantium (heartwater rickettsia)")] <- "Ehrlichia ruminantium"
tabla_new$last.class[which(tabla_new$last.class=="Elev-1554")] <- "Ktedonobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Ellin329")] <- "Alphaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Ellin515")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="Ellin6067")] <- "Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Ellin6075")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Ellin7246")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Endozoicimonaceae")] <- "Oceanospirillales"
tabla_new$last.class[which(tabla_new$last.class=="Endozoicimonas")] <- "Endozoicomonas"
tabla_new$last.class[which(tabla_new$last.class=="Enteroactinococcus coprophilus")] <- "Enteractinococcus coprophilus"
tabla_new$last.class[which(tabla_new$last.class=="Enterobacteriaceae bacterium SL1 M11")]<- "Enterobacteriaceae bacterium SL1_M11"
tabla_new$last.class[which(tabla_new$last.class=="Enterobacter sp. NISOC 03")]<- "Enterobacter sp. NISOC_03"
tabla_new$last.class[which(tabla_new$last.class=="Enterobacter sp. RV E06 4c")]<- "Enterobacter sp. RV_E06_4c"
tabla_new$last.class[which(tabla_new$last.class=="[Entotheonellales]")] <- "Deltaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Acetobacterium>")] <- "Acetobacterium"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Acidobacteria>")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Alcaligenes>")] <- "Alcaligenes"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Algoriphagus>")] <- "Algoriphagus"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Alteromonas>")] <- "Alteromonas"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Archaea>")] <- "Archaea"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Bacillus>")] <- "Bacillus"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Bacteria>")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <beta subdivision>")] <- "Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Chlorobaculum>")] <- "Chlorobaculum"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Chloroflexus>")] <- "Chloroflexus"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Cyanobacteria>")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Dehalococcoides>")] <- "Dehalococcoides"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Flavobacterium>")] <- "Flavobacterium"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Flexibacter>")] <- "Flexibacter"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <gamma proteobacteria>")] <- "Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Hyphomicrobium>")] <- "Hyphomicrobium"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Marinobacter>")] <- "Marinobacter"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Pediococcus>")] <- "Pediococcus"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Planctomycetales>")] <- "Planctomycetales"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Roseiflexus>")] <- "Roseiflexus"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Selenomonas>")] <- "Selenomonas"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <Serratia>")] <- "Serratia"
tabla_new$last.class[which(tabla_new$last.class=="environmental samples <unclassified>")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Equisetum arvense (field horsetail)")]<- "Equisetum arvense"
tabla_new$last.class[which(tabla_new$last.class=="Erwinia dispersa")] <- "Erwinia"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia albertii TW11588")] <- "Escherichia albertii"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia coli 1-110-08 S4 C3")] <- "Escherichia coli"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia coli 2-156-04 S3 C2")] <- "Escherichia coli"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia coli 2-316-03 S1 C2")] <- "Escherichia coli"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia coli 3-267-03 S1 C2")] <- "Escherichia coli"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia coli 3-373-03 S3 C3")] <- "Escherichia coli"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia coli STEC MHI813")]<- "Escherichia coli STEC_MHI813"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia Shigella coli")] <- "Escherichia coli"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia-Shigella bacterium ZH-4")] <- "bacterium ZH-4"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia/Shigella boydii")] <- "Shigella boydii"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia Shigella")] <- "Escherichia"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia-Shigella")] <- "Escherichia"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia/Shigella")] <- "Escherichia"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia/Shigella hermannii")] <- "Atlantibacter hermannii"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia/Shigella senegalensis")] <- "Escherichia senegalensis"
tabla_new$last.class[which(tabla_new$last.class=="Escherichia/Shigella sonnei")] <- "Shigella sonnei"
tabla_new$last.class[which(tabla_new$last.class=="Eubacteriaceae bacterium DJF CR57k1")]<- "Eubacteriaceae bacterium DJF_CR57k1"
tabla_new$last.class[which(tabla_new$last.class=="[Exiguobacteraceae]")] <- "Bacillales"
tabla_new$last.class[which(tabla_new$last.class=="FAC88")] <- "Elusimicrobia"
tabla_new$last.class[which(tabla_new$last.class=="Family I")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="FamilyI")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Family II")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="FamilyII")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Family III Incertae Sedis")] <- "Thermoanaerobacterales"
tabla_new$last.class[which(tabla_new$last.class=="Family Incertae Sedis")] <- "Cytophagia"
tabla_new$last.class[which(tabla_new$last.class=="Family Incertae Sedis")] <- "Dehalococcoidetes"
tabla_new$last.class[which(tabla_new$last.class=="Family IV")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Family IX")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Family VII")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Family XIII Incertae Sedis")] <- "Clostridiales"
tabla_new$last.class[which(tabla_new$last.class=="Family XI Incertae Sedis")] <- "Clostridiales"
tabla_new$last.class[which(tabla_new$last.class=="FCPU426")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Fervidomicrobium")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="[Fimbriimonadales]")] <- "Fimbriimonadales"
tabla_new$last.class[which(tabla_new$last.class=="[Fimbriimonadia]")] <- "Fimbriimonadia"
tabla_new$last.class[which(tabla_new$last.class=="Flavobacteriaceae bacterium DGP-25")] <- "Flavobacteriaceae"
tabla_new$last.class[which(tabla_new$last.class=="Flavobacteria")] <- "Flavobacteriia"
tabla_new$last.class[which(tabla_new$last.class=="Flavobacterium sp. bk 54")]<- "Flavobacterium sp. bk_54"
tabla_new$last.class[which(tabla_new$last.class=="Flavobacterium sp. enrichment culture clone BF64A C33")] <- "Flavobacterium sp."
tabla_new$last.class[which(tabla_new$last.class=="Francisella cantonensis")] <- "Allofrancisella guangzhouensis"
tabla_new$last.class[which(tabla_new$last.class=="Frankineae suborder")] <- "Frankiales"
tabla_new$last.class[which(tabla_new$last.class=="Gadus morhua (Atlantic cod)")] <- "Gadus morhua"
tabla_new$last.class[which(tabla_new$last.class=="Gallibacterium genomosp.")] <- "Gallibacterium"
tabla_new$last.class[which(tabla_new$last.class=="Gallibacterium group")] <- "Gallibacterium"
tabla_new$last.class[which(tabla_new$last.class=="Gammaproteobacteria bacterium P1 50 4AA2")] <- "Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="gamma proteobacterium NOR51-B")] <- "Luminiphilus syltensis NOR5-1B"
tabla_new$last.class[which(tabla_new$last.class=="GCA004")] <- "Anaerolineae"
tabla_new$last.class[which(tabla_new$last.class=="Geitlerinema sp. BBD P2b-1")]<- "Geitlerinema sp. BBD_P2b-1"
tabla_new$last.class[which(tabla_new$last.class=="Gemellaceae")] <- "Bacillales"
tabla_new$last.class[which(tabla_new$last.class=="Gemellales")] <- "Bacilli"
tabla_new$last.class[which(tabla_new$last.class=="Gemm-1")] <- "Gemmatimonadetes"
tabla_new$last.class[which(tabla_new$last.class=="Gemm-2")] <- "Gemmatimonadetes"
tabla_new$last.class[which(tabla_new$last.class=="Gemm-3")] <- "Gemmatimonadetes"
tabla_new$last.class[which(tabla_new$last.class=="Gemm-4")] <- "Gemmatimonadetes"
tabla_new$last.class[which(tabla_new$last.class=="Gemm-5")] <- "Gemmatimonadetes"
tabla_new$last.class[which(tabla_new$last.class=="Gemmatales")] <- "Planctomycetia"
tabla_new$last.class[which(tabla_new$last.class=="Gemmatimonadetes <class>")] <- "Gemmatimonadetes"
tabla_new$last.class[which(tabla_new$last.class=="Geobacillus subterraneus subsp. subterraneus")] <- "Geobacillus subterraneus"
tabla_new$last.class[which(tabla_new$last.class=="Geobacillus thermoleovorans CCB US3 UF5")]<- "Geobacillus thermoleovorans CCB_US3_UF5"
tabla_new$last.class[which(tabla_new$last.class=="Geobacter chapelleii")]<- "Geobacter chapellei"
tabla_new$last.class[which(tabla_new$last.class=="GIF9")] <- "Dehalococcoidia"
tabla_new$last.class[which(tabla_new$last.class=="GKS98 freshwater group")] <- "Alcaligenaceae"
tabla_new$last.class[which(tabla_new$last.class=="Glaciecola punicea DSM 14233 = ACAM 611")] <- "Glaciecola punicea"
tabla_new$last.class[which(tabla_new$last.class=="Gluconacetobacter diazotrophicus PAl 5")] <- "Gluconacetobacter diazotrophicus PA1 5"
tabla_new$last.class[which(tabla_new$last.class=="Gluconobacter krungthepensis")] <- "Gluconobacter"
tabla_new$last.class[which(tabla_new$last.class=="GMD14H09")] <- "Deltaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GN15")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="GOBB3-C201")] <- "Sphingomonadales"
tabla_new$last.class[which(tabla_new$last.class=="Gp1")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp21")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp22")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp2")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp3")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp4")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp5")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp6")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp7")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gp9")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpI")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpIIa")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpIIb")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpIII")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpIV")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpIX")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpV")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpVI")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpVII")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpVIII")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpX")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpXI")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpXII")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GpXIII")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Gracilibacillus sp. YIM C229")] <- "Gracilibacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Granulosicoccus sp. Z271")] <- "Granulosicoccus sp."
tabla_new$last.class[which(tabla_new$last.class=="Gulbenkianus")] <- "Gulbenkiania"
tabla_new$last.class[which(tabla_new$last.class=="GW-28")] <- "Deltaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="GZKB119")] <- "Bacteroidales"
tabla_new$last.class[which(tabla_new$last.class=="Hafnia-Obesumbacterium")] <- "Enterobacteriaceae"
tabla_new$last.class[which(tabla_new$last.class=="Hafnia-Obesumbacterium")] <- "Hafnia"
tabla_new$last.class[which(tabla_new$last.class=="Hahella unidentified")] <- "Hahella"
tabla_new$last.class[which(tabla_new$last.class=="Halobacteriaceae Group")] <- "Halobacteriaceae"
tabla_new$last.class[which(tabla_new$last.class=="Halocella cellulolsilytica")] <- "Halocella cellulosilytica"
tabla_new$last.class[which(tabla_new$last.class=="HB2-32-21")] <- "Alteromonadaceae"
tabla_new$last.class[which(tabla_new$last.class=="Helianthus annuus (common sunflower)")] <- "Helianthus annuus"
tabla_new$last.class[which(tabla_new$last.class=="Helicobacter uncultured bacterium")] <- "Helicobacter"
tabla_new$last.class[which(tabla_new$last.class=="HMMVPog-54")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="HOC36")] <- "Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Homalodisca vitripennis (glassy-winged sharpshooter)")] <- "Homalodisca vitripennis"
tabla_new$last.class[which(tabla_new$last.class=="HTCC2089")] <- "Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="HTCC2188")] <- "Alteromonadales"
tabla_new$last.class[which(tabla_new$last.class=="HTCC")] <- "Alteromonadales"
tabla_new$last.class[which(tabla_new$last.class=="Huperzia lucidula (shining club moss)")] <- "Huperzia lucidula"
tabla_new$last.class[which(tabla_new$last.class=="hydrothermal vent eubacterium PVB OTU 2")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="hydrothermal vent eubacterium PVB OTU 5")]<- "hydrothermal vent eubacterium PVB_OTU_5"
tabla_new$last.class[which(tabla_new$last.class=="hydrothermal vent eubacterium PVB OTU 6")]<- "hydrothermal vent eubacterium PVB_OTU_6"
tabla_new$last.class[which(tabla_new$last.class=="Ignavibacteriales lheB3-7")] <- "Ignavibacteriales"
tabla_new$last.class[which(tabla_new$last.class=="iii1 15")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="iii1-15 mb2424")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Ilumatobacter actinobacterium YM22-133")] <- "Ilumatobacter"
tabla_new$last.class[which(tabla_new$last.class=="Incertae Sedis")] <- "Lachnospiraceae"
tabla_new$last.class[which(tabla_new$last.class=="intranuclear bacterium of Bathymodiolus spp")] <- "Endozoicomonas"
tabla_new$last.class[which(tabla_new$last.class=="iodide-oxidizers")] <- "Alphaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="IS-44")] <- "Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Isoetes engelmannii (Engelmann's quillwort)")] <- "Isoetes engelmannii"
tabla_new$last.class[which(tabla_new$last.class=="'Jeotgalibacillus soli' Cunha et al. 2011")] <- "Jeotgalibacillus soli Cunha et al. 2012"
tabla_new$last.class[which(tabla_new$last.class=="JTB215")] <- "Clostridiales"
tabla_new$last.class[which(tabla_new$last.class=="JTB38")] <- "Deltaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Kaistina")] <- "Kaistia"
tabla_new$last.class[which(tabla_new$last.class=="Kaistobacter")] <- "Sphingomonas"
tabla_new$last.class[which(tabla_new$last.class=="Kaistobacter terrae")] <- "'Sphingomonas ginsengisoli' Hoang et al. 2012"
tabla_new$last.class[which(tabla_new$last.class=="KD1-23")] <- "Rhodocyclaceae"
tabla_new$last.class[which(tabla_new$last.class=="KD8-87")] <- "Gemmatimonadetes"
tabla_new$last.class[which(tabla_new$last.class=="Ketogulonigenium vulgarum WSH-001")] <- "Ketogulonicigenium vulgare WSH-001"
tabla_new$last.class[which(tabla_new$last.class=="Ketogulonigenium vulgarum WSH-001")] <- "Ketogulonigenium vulgarum"
tabla_new$last.class[which(tabla_new$last.class=="Klebsiella pneumoniae 30660/NJST258 1")] <- "Klebsiella pneumoniae"
tabla_new$last.class[which(tabla_new$last.class=="Klebsiella pneumoniae UCICRE 10")] <- "Klebsiella pneumoniae"
tabla_new$last.class[which(tabla_new$last.class=="Klebsiella sp. enrichment culture clone SRC DSA18")] <- "Klebsiella sp."
tabla_new$last.class[which(tabla_new$last.class=="Klebsiella sp. enrichment culture clone SRC DSB12")] <- "Klebsiella sp."
tabla_new$last.class[which(tabla_new$last.class=="Klebsiella sp. enrichment culture clone SRC DSB20")] <- "Klebsiella sp."
tabla_new$last.class[which(tabla_new$last.class=="Klebsiella sp. enrichment culture clone SRC DSD24")] <- "Klebsiella sp."
tabla_new$last.class[which(tabla_new$last.class=="Klebsiella sp. ICB365")] <- "Klebsiella sp. ICB 365"
tabla_new$last.class[which(tabla_new$last.class=="koll11")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Koribacteraceae")]<- "Coriobacteriaceae"
tabla_new$last.class[which(tabla_new$last.class=="[Kouleothrixaceae]")] <- "Chloroflexi"
tabla_new$last.class[which(tabla_new$last.class=="KSB3")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Lachnospiracea_incertae_sedis")] <- "Lachnospiraceae"
tabla_new$last.class[which(tabla_new$last.class=="Lactobacillus sp. 1.1424")] <- "Lactobacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Latescibacteria_genera_incertae_sedis")] <- "Candidatus Latescibacteria"
tabla_new$last.class[which(tabla_new$last.class=="LD1-PA13")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="LD1-PB3")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="Lens culinaris (lentil)")] <- "Lens culinaris"
tabla_new$last.class[which(tabla_new$last.class=="[Lentisphaeria]")] <- "Lentisphaeria"
tabla_new$last.class[which(tabla_new$last.class=="Leptolyngbya sp. LEGE 07074")] <- "Leptolyngbya"
tabla_new$last.class[which(tabla_new$last.class=="[Leptospirae]")] <- "Spirochaetes"
tabla_new$last.class[which(tabla_new$last.class=="Leptospirillum uncultured bacterium")] <- "Leptospirillum"
tabla_new$last.class[which(tabla_new$last.class=="Leptothrix sp. FG 68")] <- "Leptothrix sp."
tabla_new$last.class[which(tabla_new$last.class=="LG048")] <- "Spirochaetes"
tabla_new$last.class[which(tabla_new$last.class=="LH041")] <- "Spirochaetes"
tabla_new$last.class[which(tabla_new$last.class=="Limnothrix planctonica CHAB709")] <- "Limnothrix planktonica CHAB709"
tabla_new$last.class[which(tabla_new$last.class=="Limnothrix planctonica CHAB753")]<- "Limnothrix planktonica CHAB753"
tabla_new$last.class[which(tabla_new$last.class=="Lineage I")] <- "Elusimicrobia"
tabla_new$last.class[which(tabla_new$last.class=="LP2A")] <- "Methylacidiphilaceae"
tabla_new$last.class[which(tabla_new$last.class=="Lytechinus variegatus (green sea urchin)")] <- "Lytechinus variegatus"
tabla_new$last.class[which(tabla_new$last.class=="Magnetococcus sp.")] <- "Magnetococcus"
tabla_new$last.class[which(tabla_new$last.class=="Magnetococcus sp. SS-1")] <- "Magnetococcus marinus MC-1"
tabla_new$last.class[which(tabla_new$last.class=="Marchantia polymorpha (liverwort)")]<- "Marchantia polymorpha"
tabla_new$last.class[which(tabla_new$last.class=="marine group cyanobacterium UCYN-A")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="[Marinicellaceae]")] <- "Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Marinilabiaceae")] <- "Marinilabiliaceae"
tabla_new$last.class[which(tabla_new$last.class=="Marinilutecoccus nanhaiensis")] <- "Mariniluteicoccus flavus"
tabla_new$last.class[which(tabla_new$last.class=="Marinimicrobium sp.")] <- "Marinimicrobium"
tabla_new$last.class[which(tabla_new$last.class=="Marinimicrobium sp. yn3")] <- "Gilvimarinus polysaccharolyticus"
tabla_new$last.class[which(tabla_new$last.class=="Marinobacterium marisflavum")] <- "Marinobacterium marisflavi"
tabla_new$last.class[which(tabla_new$last.class=="Marinomonas brasiliensis")] <- "Marinomonas brasilensis"
tabla_new$last.class[which(tabla_new$last.class=="Marivita sp. CB 1101")] <- "Marivita sp."
tabla_new$last.class[which(tabla_new$last.class=="Marmoricola sp. MSL 05")] <- "Marmoricola sp."
tabla_new$last.class[which(tabla_new$last.class=="MAT-CR-H6-H10")] <- "Fibrobacteres"
tabla_new$last.class[which(tabla_new$last.class=="MB11C04")] <- "Puniceicoccaceae"
tabla_new$last.class[which(tabla_new$last.class=="MCG pGrfC26")] <- "Crenarchaeota"
tabla_new$last.class[which(tabla_new$last.class=="Mesorhizobium sp. CP3")] <- "Mesorhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Methanobacterium sp. SWAN-1")] <- "Methanobacterium paludis"
tabla_new$last.class[which(tabla_new$last.class=="[Methanomassiliicoccaceae] vadinCA11")] <- "Methanomassiliicoccaceae"
tabla_new$last.class[which(tabla_new$last.class=="Methylobacterium sp. OX1 1 1 S1")]<- "Methylobacterium sp. OX1_1_1_S1"
tabla_new$last.class[which(tabla_new$last.class=="Methylobacterium sp. SAP46 2")]<- "Methylobacterium sp. SAP46_2"
tabla_new$last.class[which(tabla_new$last.class=="Methylonatronum")] <- "Methylonatrum"
tabla_new$last.class[which(tabla_new$last.class=="[Micrarchaeles]")] <- "Candidatus Parvarchaeota"
tabla_new$last.class[which(tabla_new$last.class=="Microbulbifer halotolerans")] <- "Microbulbifer halophilus"
tabla_new$last.class[which(tabla_new$last.class=="mitochondria")] <- "Eukaryota"
tabla_new$last.class[which(tabla_new$last.class=="Mitochondria")] <- "Eukaryota"
tabla_new$last.class[which(tabla_new$last.class=="MKC10")] <- "Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="ML110J-20")] <- "Saccharospirillaceae"
tabla_new$last.class[which(tabla_new$last.class=="ML615J-28")] <- "Tenericutes"
tabla_new$last.class[which(tabla_new$last.class=="ML635J-21")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="ML635J-40")] <- "Bacteroidales"
tabla_new$last.class[which(tabla_new$last.class=="MND1")] <- "Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="MNG3")] <- "Alphaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Mongolicoccus roser")] <- "Mongoliicoccus roseus"
tabla_new$last.class[which(tabla_new$last.class=="Moraxella (Branhamella) caviae")] <- "Moraxella caviae"
tabla_new$last.class[which(tabla_new$last.class=="MSB-1E9")] <- "Anaerolineae"
tabla_new$last.class[which(tabla_new$last.class=="MSB-5A5")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="MSB-5B5")] <- "Caldithrix"
tabla_new$last.class[which(tabla_new$last.class=="MSBL3")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="Muricola jejuensis")] <- "Muriicola jejuensis"
tabla_new$last.class[which(tabla_new$last.class=="MVS-40")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="MVS-65")] <- "Solibacterales"
tabla_new$last.class[which(tabla_new$last.class=="Mycobacterium alsiensis")] <- "Mycobacterium alsense"
tabla_new$last.class[which(tabla_new$last.class=="Mycobacterium avium complex ")] <- "Mycobacterium avium complex"
tabla_new$last.class[which(tabla_new$last.class=="Mycobacterium sp. INBio 4513R")] <- "Mycobacterium sp."
tabla_new$last.class[which(tabla_new$last.class=="N1423WL")] <- "Gemmatimonadetes"
tabla_new$last.class[which(tabla_new$last.class=="Nannospalax galili (Upper Galilee mountains blind mole rat)")] <- "Nannospalax galili"
tabla_new$last.class[which(tabla_new$last.class=="Natranaerobiaceae bacterium Z1001")] <- "Natranaerobaculum magadiense"
tabla_new$last.class[which(tabla_new$last.class=="NB1-j")] <- "Deltaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="NC10")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="ND137")] <- "Alteromonadaceae"
tabla_new$last.class[which(tabla_new$last.class=="Neisseria_cinerea")] <- "Neisseria cinerea"
tabla_new$last.class[which(tabla_new$last.class=="Neisseria flava mucosa pharyngis")] <- "Neisseria pharyngis subsp. flava"
tabla_new$last.class[which(tabla_new$last.class=="Neptuniibacter ")] <- "Neptuniibacter"
tabla_new$last.class[which(tabla_new$last.class=="Nicotiana tabacum (common tobacco)")] <- "Nicotiana tabacum"
tabla_new$last.class[which(tabla_new$last.class=="Nitrosococcus halophilus Nc4")] <- "Nitrosococcus halophilus"
tabla_new$last.class[which(tabla_new$last.class=="NKB15")] <- "Deltaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="NKB19")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Nocardiopsis sp. 20028")] <- "Nocardiopsis valliformis DSM 45023"
tabla_new$last.class[which(tabla_new$last.class=="Nostocaceae cyanobacterium")] <- "Nostocaceae"
tabla_new$last.class[which(tabla_new$last.class=="Nostocaceae cyanobacterium SAG B11.82")] <- "Cylindrospermum siamensis SAG 11.82"
tabla_new$last.class[which(tabla_new$last.class=="Nostocaceae cyanobacterium SAG B11.82")] <- "Nostocaceae cyanobacterium"
tabla_new$last.class[which(tabla_new$last.class=="'Nostoc")] <- "Nostoc"
tabla_new$last.class[which(tabla_new$last.class=="Nostocoida limicola")] <- "Nostocoida limicola I"
tabla_new$last.class[which(tabla_new$last.class=="Nostocophycideae")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="NPL-UPA2")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="NS11-12")] <- "Sphingobacteriales"
tabla_new$last.class[which(tabla_new$last.class=="NS5")] <- "Flavobacteriaceae"
tabla_new$last.class[which(tabla_new$last.class=="NS9")] <- "Flavobacteriales"
tabla_new$last.class[which(tabla_new$last.class=="OC31")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="OCS116 clade")] <- "Alphaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Octadecabacter antarcticus 238")] <- "Octadecabacter antarcticus"
tabla_new$last.class[which(tabla_new$last.class=="OD1")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="ODP123")] <- "Planctomycetes"
tabla_new$last.class[which(tabla_new$last.class=="OM190")] <- "Planctomycetes"
tabla_new$last.class[which(tabla_new$last.class=="OM27")] <- "Myxococcales"
tabla_new$last.class[which(tabla_new$last.class=="OM60")] <- "Halieaceae"
tabla_new$last.class[which(tabla_new$last.class=="OM60(NOR5) clade")] <- "Alteromonadaceae"
tabla_new$last.class[which(tabla_new$last.class=="OP10")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="OP10_genera_incertae_sedis")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="OP8")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="OP8 1")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="OP8_1")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="OP9")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="OPB11")] <- "Anaerolineae"
tabla_new$last.class[which(tabla_new$last.class=="OPB46")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="OPB54")] <- "Clostridia"
tabla_new$last.class[which(tabla_new$last.class=="OPB56")] <- "Chlorobi"
tabla_new$last.class[which(tabla_new$last.class=="Ophioglossum vulgatum (southern adder's-tongue)")] <- "Ophioglossum vulgatum"
tabla_new$last.class[which(tabla_new$last.class=="Order Incertae Sedis")] <- "Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Oryza sativa (rice)")] <- "Oryza sativa"
tabla_new$last.class[which(tabla_new$last.class=="Paenibacillaceae 1 1")] <- "Paenibacillaceae"
tabla_new$last.class[which(tabla_new$last.class=="Paenibacillaceae 1")] <- "Paenibacillaceae"
tabla_new$last.class[which(tabla_new$last.class=="Paenibacillus sp. 112T")] <- "Paenibacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Paenibacillus sp. 7188T")] <- "Paenibacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Paenibacillus sp. Cp S316")] <- "Paenibacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Paenibacillus sp. KOPRI80157")] <- "Paenibacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Paenibacillus sp. TW-1")] <- "Paenibacillus sp."
tabla_new$last.class[which(tabla_new$last.class=="Paludimonas")] <- "Paludibacterium"
tabla_new$last.class[which(tabla_new$last.class=="Pantoea oleae")] <- "Erwinia oleae"
tabla_new$last.class[which(tabla_new$last.class=="Pantoea sp. SAP16 1")]<- "Pantoea sp. SAP16_1"
tabla_new$last.class[which(tabla_new$last.class=="Paracoccus sp. YXX-4")] <- "Paracoccus sp."
tabla_new$last.class[which(tabla_new$last.class=="[Pasteurella] pneumotropica")] <- "Rodentibacter pneumotropicus"
tabla_new$last.class[which(tabla_new$last.class=="PAUC37f")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Pealius kelloggii (Kellogg's whitefly)")] <- "Pealius kelloggii"
tabla_new$last.class[which(tabla_new$last.class=="Pectobacterium sp. carotovorum")]<- "Pectobacterium carotovorum"
tabla_new$last.class[which(tabla_new$last.class=="Pedosphaerae")] <- "Pedosphaera"
tabla_new$last.class[which(tabla_new$last.class=="[Pedosphaerae]")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="PeM15")] <- "Actinobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Peptococcaceae 1 1")] <- "Peptococcaceae"
tabla_new$last.class[which(tabla_new$last.class=="Peptococcaceae 1")] <- "Peptococcaceae"
tabla_new$last.class[which(tabla_new$last.class=="Peptococcaceae 2 2")] <- "Peptococcaceae"
tabla_new$last.class[which(tabla_new$last.class=="Peptococcaceae 2")] <- "Peptococcaceae"
tabla_new$last.class[which(tabla_new$last.class=="Phaseolus acutifolius (tepary bean)")] <- "Phaseolus acutifolius"
tabla_new$last.class[which(tabla_new$last.class=="Phormidiaceae")] <- "Oscillatoriales"
tabla_new$last.class[which(tabla_new$last.class=="Phormidium pseudopristleyi")] <- "Phormidium pseudopriestleyi"
tabla_new$last.class[which(tabla_new$last.class=="Phormidium sp. LEGE 07310")] <- "Phormidium sp."
tabla_new$last.class[which(tabla_new$last.class=="PHOS-HD29")] <- "Proteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Photobacterium damselae subsp. piscicida (causative agent of fish")] <- "Photobacterium damselae subsp. piscicida"
tabla_new$last.class[which(tabla_new$last.class=="Phyllocladus trichomanoides (celery pine)")] <- "Phyllocladus trichomanoides"
tabla_new$last.class[which(tabla_new$last.class=="Picea glauca (white spruce)")] <- "Picea glauca"
tabla_new$last.class[which(tabla_new$last.class=="Pir4")] <- "Planctomycetaceae"
tabla_new$last.class[which(tabla_new$last.class=="Pirellulaceae")] <- "Planctomycetia"
tabla_new$last.class[which(tabla_new$last.class=="Pirellulales")] <- "Planctomycetacia"
tabla_new$last.class[which(tabla_new$last.class=="Piscirickettsiaceae endosymbionts")] <- "Piscirickettsiaceae"
tabla_new$last.class[which(tabla_new$last.class=="Pisum sativum (pea)")] <- "Pisum sativum"
tabla_new$last.class[which(tabla_new$last.class=="Poriferibacter numazuense")] <- "Spongitalea numazuensis"
tabla_new$last.class[which(tabla_new$last.class=="Poriferibacter")] <- "Spongitalea"
tabla_new$last.class[which(tabla_new$last.class=="Prevotella 1")] <- "Prevotella"
tabla_new$last.class[which(tabla_new$last.class=="Prevotella 7")] <- "Prevotella"
tabla_new$last.class[which(tabla_new$last.class=="Prevotellaceae bacterium DJF CR21k6")]<- "Prevotellaceae bacterium DJF_CR21k6"
tabla_new$last.class[which(tabla_new$last.class=="Prevotellaceae bacterium DJF CR25")]<- "Prevotellaceae bacterium DJF_CR25"
tabla_new$last.class[which(tabla_new$last.class=="Prevotella_melaninogenica")] <- "Prevotella melaninogenica"
tabla_new$last.class[which(tabla_new$last.class=="[Prevotella]")] <- "Prevotella"
tabla_new$last.class[which(tabla_new$last.class=="[Prevotella] tannerae")] <- "Prevotella"
tabla_new$last.class[which(tabla_new$last.class=="Proteus sp. 118 5")] <- "Proteus sp."
tabla_new$last.class[which(tabla_new$last.class=="PRR-10")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="PRR-11")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="PRR-12")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="PSB-M-3")] <- "Erysipelotrichaceae"
tabla_new$last.class[which(tabla_new$last.class=="Pseudanabaenales")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Pseudanabaenales")] <- "Synechococcales"
tabla_new$last.class[which(tabla_new$last.class=="Pseudoalteromonas sp. M71 D107")] <- "Pseudoalteromonas sp."
tabla_new$last.class[which(tabla_new$last.class=="Psychroflexus_torquis")] <- "Psychroflexus torquis"
tabla_new$last.class[which(tabla_new$last.class=="Pullulanibacillus mentitum")] <- "Pullulanibacillus uraniitolerans"
tabla_new$last.class[which(tabla_new$last.class=="Puniceibacter")] <- "Puniceicoccus"
tabla_new$last.class[which(tabla_new$last.class=="Pusillimonas terrae")] <- "Parapusillimonas granuli"
tabla_new$last.class[which(tabla_new$last.class=="Quinella ovalis ")] <- "Quinella ovalis"
tabla_new$last.class[which(tabla_new$last.class=="Quinella ovalis (Quin's oval)")] <- "Quinella ovalis"
tabla_new$last.class[which(tabla_new$last.class=="R4-41B")] <- "Verrucomicrobiales"
tabla_new$last.class[which(tabla_new$last.class=="Rahnella sp. INBio 4048I")] <- "Rahnella sp."
tabla_new$last.class[which(tabla_new $last.class=="RB25")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="RB25")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="RB40")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="RB41")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="RF32")] <- "Alphaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Rhizobiales (rhizobacteria)")] <- "Rhizobiales"
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium etli Kim 5")] <- "Rhizobium etli"
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium sp. Cap B9")] <- "Rhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium sp. Cap K13")] <- "Rhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium sp. CRRI-78 WR2")] <- "Rhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium sp. CRRI-80 WR9")] <- "Rhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium sp. MSAP L2")] <- "Rhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium sp. MSAP L4")]<- "Rhizobium sp. MSAP_L4"
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium sp. MSAP L5")] <- "Rhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium sp. MSAP L5")]<- "Rhizobium sp. MSAP_L5"
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium sp. R22 Indore 3c")] <- "Rhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium sp. R3 Anuppur")] <- "Rhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium sp. R51 Pantnagar")] <- "Rhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium sp. R9 Dewas")] <- "Rhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhizobium sp. SIB Cu E9")] <- "Rhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhodanobacter sp. IMER-B2-6")] <- "Rhodanobacter sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhodococcus <Bacteria>")] <- "Rhodococcus"
tabla_new$last.class[which(tabla_new$last.class=="Rhodococcus cerastrii")] <- "Rhodococcus cerastii"
tabla_new$last.class[which(tabla_new$last.class=="Rhodococcus sp. NIO-201101")] <- "Rhodococcus sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhodococcus sp. PBTS1")] <- "Rhodococcus sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhodococcus sp. P wp0223")] <- "Rhodococcus sp."
tabla_new$last.class[which(tabla_new$last.class=="Rhodoligotropha projecta")] <- "Rhodoligotrophos appendicifer"
tabla_new$last.class[which(tabla_new$last.class=="Rhodopseudomonas pangongensis")] <- "Rhodopseudomonas parapalustris"
tabla_new$last.class[which(tabla_new$last.class=="Rhodospirillum sp. kmd 475")] <- "Rhodospirillum"
tabla_new$last.class[which(tabla_new$last.class=="[Rhodothermales]")] <- "Rhodothermales"
tabla_new$last.class[which(tabla_new$last.class=="Rhodovulum thermophilus")] <- "Jhaorihella thermophila"
tabla_new$last.class[which(tabla_new$last.class=="Ricinus communis (castor bean)")] <- "Ricinus communis"
tabla_new$last.class[which(tabla_new$last.class=="Rickettsia akari (agent of rickettsialpox)")] <- "Rickettsia akari"
tabla_new$last.class[which(tabla_new$last.class=="Rickettsia akari ")] <- "Rickettsia akari"
tabla_new$last.class[which(tabla_new$last.class=="Riemerella sp. R8091")] <- "Riemerella"
tabla_new$last.class[which(tabla_new$last.class=="[Roseiflexales]")] <- "Chloroflexales"
tabla_new$last.class[which(tabla_new$last.class=="Roseiflexus hot springs metagenome")] <- "Roseiflexus"
tabla_new$last.class[which(tabla_new$last.class=="Roseobacter clade AS-21 lineage")] <- "Roseobacter"
tabla_new$last.class[which(tabla_new$last.class=="Roseomonas genomospecies")] <- "Roseomonas"
tabla_new$last.class[which(tabla_new$last.class=="RS62")] <- "Comamonadaceae"
tabla_new$last.class[which(tabla_new$last.class=="Rubrobacteriaceae")] <- "Rubrobacteraceae"
tabla_new$last.class[which(tabla_new$last.class=="rumen bacterium NK3A76")] <- "Ruminococcus sp. NK3A76"
tabla_new$last.class[which(tabla_new$last.class=="rumen bacterium NK3D112")] <- "Erysipelotrichaceae bacterium NK3D112"
tabla_new$last.class[which(tabla_new$last.class=="Ruminococcaceae Group")] <- "Ruminococcaceae"
tabla_new$last.class[which(tabla_new$last.class=="Ruminococcus2")] <- "Ruminococcus"
tabla_new$last.class[which(tabla_new$last.class=="[Ruminococcus]")] <- "Ruminococcus"
tabla_new$last.class[which(tabla_new$last.class=="S0208")] <- "Anaerolineae"
tabla_new$last.class[which(tabla_new$last.class=="S035")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="S085")] <- "Chloroflexi"
tabla_new$last.class[which(tabla_new$last.class=="S24 7")] <- "Bacteroidales"
tabla_new$last.class[which(tabla_new$last.class=="S24-7")] <- "Bacteroidales"
tabla_new$last.class[which(tabla_new$last.class=="Saccharopolyspora salina")] <- "Saccharopolyspora qijiaojingensis"
tabla_new$last.class[which(tabla_new$last.class=="Saccharopolyspora thermophilus")] <- "Saccharopolyspora thermophila"
tabla_new$last.class[which(tabla_new$last.class=="Saccharothrix sp. UTMC 537")] <- "Saccharothrix sp."
tabla_new$last.class[which(tabla_new$last.class=="Salinimonas sp. TB131 1")]<- "Salinimonas sp. TB131_1"
tabla_new$last.class[which(tabla_new$last.class=="Salinisphaera dokdoensis")] <- "Salinisphaera dokdonensis"
tabla_new$last.class[which(tabla_new$last.class=="Salinispora sp. UKMCC T112")]<- "Salinispora sp. UKMCC_T112"
tabla_new$last.class[which(tabla_new$last.class=="Salmonella enterica subsp. enterica serovar Gallinarum/pullorum str")] <- "Salmonella enterica subsp. enterica serovar Gallinarum"
tabla_new$last.class[which(tabla_new$last.class=="Salmonella enterica subsp. enterica serovar Gallinarum/pullorum str.")] <- "Salmonella enterica subsp. enterica serovar Gallinarum var. Pullorum str. 76059"
tabla_new$last.class[which(tabla_new$last.class=="Salmonella enterica subsp. enterica serovar Typhimurium str.")] <- "Salmonella enterica subsp. enterica"
tabla_new$last.class[which(tabla_new$last.class=="Sanguinaria canadensis (red puccoon)")] <- "Sanguinaria canadensis"
tabla_new$last.class[which(tabla_new$last.class=="[Saprospirales]")] <- "Saprospirales"
tabla_new$last.class[which(tabla_new$last.class=="SAR202")] <- "Chloroflexi"
tabla_new$last.class[which(tabla_new$last.class=="SAR324")] <- "Deltaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="SB1-18")] <- "Alphaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="SB-45")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="SBla14")] <- "Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="SBR1031")] <- "Anaerolineae"
tabla_new$last.class[which(tabla_new$last.class=="SBYG_4172")] <- "Clostridiales"
tabla_new$last.class[which(tabla_new$last.class=="SBYO 3720")] <- "Chloroflexales"
tabla_new$last.class[which(tabla_new$last.class=="SBYO_3720")] <- "Chloroflexales"
tabla_new$last.class[which(tabla_new$last.class=="SC I 84")] <- "Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="SC-I-84")] <- "Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Scytonema arcangeli")] <- "Scytonema arcangelii"
tabla_new$last.class[which(tabla_new$last.class=="Sediment 1")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Sediment-4")] <- "Leptospirales"
tabla_new$last.class[which(tabla_new$last.class=="Sedimentibacter sp. MO-SED")] <- "Sedimentibacter sp."
tabla_new$last.class[which(tabla_new$last.class=="Serratia sp. WW4")] <- "Serratia sp."
tabla_new$last.class[which(tabla_new$last.class=="SGSH944")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="SHA 20")] <- "Anaerolineae"
tabla_new$last.class[which(tabla_new$last.class=="SHA-26")] <- "Chloroflexi"
tabla_new$last.class[which(tabla_new$last.class=="SHA-43")] <- "Phycisphaerae"
tabla_new$last.class[which(tabla_new$last.class=="SHA-98")] <- "Clostridia"
tabla_new$last.class[which(tabla_new$last.class=="SHD-231")] <- "Anaerolineaceae"
tabla_new$last.class[which(tabla_new$last.class=="Shewanella marinus")] <- "Shewanella marina"
tabla_new$last.class[which(tabla_new$last.class=="Shewanella sp. MFC 2")]<- "Shewanella sp. MFC_2"
tabla_new$last.class[which(tabla_new$last.class=="Shigella flexneri J1713")] <- "Shigella flexneri"
tabla_new$last.class[which(tabla_new$last.class=="Silene vulgaris (bladder campion)")] <- "Silene vulgaris"
tabla_new$last.class[which(tabla_new$last.class=="Sinorhizobium sp. AWS-3")] <- "Sinorhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Sinorhizobium sp. bD51")] <- "Sinorhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Sinorhizobium sp. YZJ-1")] <- "Sinorhizobium sp."
tabla_new$last.class[which(tabla_new$last.class=="Sitophilus zeamais (maize weevil)")] <- "Sitophilus zeamais"
tabla_new$last.class[which(tabla_new$last.class=="SJA-15")] <- "Anaerolineae"
tabla_new$last.class[which(tabla_new$last.class=="SJA-4")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="SM1A07")] <- "Bacteroidetes"
tabla_new$last.class[which(tabla_new$last.class=="SM1B02")] <- "Chlorobia"
tabla_new$last.class[which(tabla_new$last.class=="Solanum melongena ")] <- "Solanum melongena"
tabla_new$last.class[which(tabla_new$last.class=="Solanum tuberosum (potato)")] <- "Solanum tuberosum"
tabla_new$last.class[which(tabla_new$last.class=="Solibium")] <- "Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Sorangium cellulosum 'So ce 56'")] <- "Sorangium cellulosum"
tabla_new$last.class[which(tabla_new$last.class=="Spartobacteria_genera_incertae_sedis")] <- "Spartobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Sphaerochaeta globus str. Buddy")] <- "Sphaerochaeta globosa"
tabla_new$last.class[which(tabla_new$last.class=="Sphingomonas suberifaciens (corky root of lettuce)")] <- "Sphingomonas suberifaciens"
tabla_new$last.class[which(tabla_new$last.class=="Spirobacillales")] <- "Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Sporichthyaceae hgcI")] <- "Sporichthyaceae"
tabla_new$last.class[which(tabla_new$last.class=="Sporolactobacillaceae incertae sedis")] <- "Sporolactobacillaceae"
tabla_new$last.class[which(tabla_new$last.class=="Sporolactobacillaceae_incertae_sedis")] <- "Sporolactobacillaceae"
tabla_new$last.class[which(tabla_new$last.class=="Sporosarcina ginsengi")] <- "Sporosarcina"
tabla_new$last.class[which(tabla_new$last.class=="ST-3K15")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Stenotrophomonas geniculata")] <- "Stenotrophomonas"
tabla_new$last.class[which(tabla_new$last.class=="Stenotrophomonas retroflexus")] <- "Stenotrophomonas"
tabla_new$last.class[which(tabla_new$last.class=="Stigonema sp. UAM 342")] <- "Stigonema"
tabla_new$last.class[which(tabla_new$last.class=="Streptacidiphilus griseosporeus")] <- "Streptacidiphilus griseisporus"
tabla_new$last.class[which(tabla_new$last.class=="Streptococcus luteciae")] <- "Streptococcus lutetiensis"
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. 08-40-02-1")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. 5340")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. Av26 3")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. CN207")]<- "Streptomyces tunisiensis"
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. CNQ-027 SD01")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. CNS-730 SD06 MAR2")]<- "Streptomyces sp. CNS-730_SD06_MAR2"
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. G2 2")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. GBA 94-11")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. INBio 4504AG")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. INBio 4516X")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. L180")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. L-2 19")]<- "Streptomyces sp. L-2_19"
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. MPWIWi03 BR03")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. MPWIWi03 PL04")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. OS3 95")]<- "Streptomyces"
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. PVA 117-04")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. SCM MKF-8")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. TRM46012")] <- "Streptomyces sp."
tabla_new$last.class[which(tabla_new$last.class=="Streptomyces sp. UKMCC T109")]<- "Streptomyces sp. UKMCC_T109"
tabla_new$last.class[which(tabla_new$last.class=="subclass")] <- "Actinobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Subdivision3_genera_incertae_sedis")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="Subdivision3")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="Subdivision5_genera_incertae_sedis")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="Subdivision5")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="SubgroupI")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="suborder")] <- "Actinobacteria"
tabla_new$last.class[which(tabla_new$last.class=="SubsectionII")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="SubsectionIII")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="SubsectionI")] <- "Oscillatoriophycideae"
tabla_new$last.class[which(tabla_new$last.class=="SubsectionIV")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Sulfurimonas uncultured bacterium")] <- "Sulfurimonas"
tabla_new$last.class[which(tabla_new$last.class=="SUP05")] <- "Oceanospirillales"
tabla_new$last.class[which(tabla_new$last.class=="Sva0725")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Sva0853")] <- "Deltaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Synechococcophycideae")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Synechococcus sp. JA-2-3B'a")] <- "Synechococcus sp."
tabla_new$last.class[which(tabla_new$last.class=="T78")] <- "Anaerolineaceae"
tabla_new$last.class[which(tabla_new$last.class=="Taenia solium (pork tapeworm)")] <- "Taenia solium"
tabla_new$last.class[which(tabla_new$last.class=="TBZ33")] <- "Oceanospirillales"
tabla_new$last.class[which(tabla_new$last.class=="Tenacibaculum sp. CNURIC 013")] <- "Tenacibaculum sp."
tabla_new$last.class[which(tabla_new$last.class=="TG3")] <- "Fibrobacteres"
tabla_new$last.class[which(tabla_new$last.class=="Thalassobius sp. EDB2")] <- "Thalassobius sp."
tabla_new$last.class[which(tabla_new$last.class=="Thalassobius sp. GSW-6")] <- "Thalassobius sp."
tabla_new$last.class[which(tabla_new$last.class=="Thalassobius sp.")] <- "Thalassobius"
tabla_new$last.class[which(tabla_new$last.class=="Thermoanerobacter brockii subsp. lactiethylicus")] <- "Thermoanerobacter brockii"
tabla_new$last.class[which(tabla_new$last.class=="Thermoanerobacter brockii")] <- "Thermoanaerobacter"
tabla_new$last.class[which(tabla_new$last.class=="[Thermobacula]")] <- "Chloroflexi"
tabla_new$last.class[which(tabla_new$last.class=="Thermodesulfobacterium sp. OPB45")] <- "Thermodesulfobacterium sp."
tabla_new$last.class[which(tabla_new$last.class=="[Thermodesulfovibrionaceae]")] <- "Nitrospiraceae"
tabla_new$last.class[which(tabla_new$last.class=="Thermomonas dokdonensis")] <- "Lysobacter dokdonensis"
tabla_new$last.class[which(tabla_new$last.class=="Thioalkalimicrobium gamma proteobacterium ASL1")] <- "Thioalkalimicrobium"
tabla_new$last.class[which(tabla_new$last.class=="Thioalkalivibrio gamma proteobacterium ASL10")] <- "Thioalkalivibrio"
tabla_new$last.class[which(tabla_new$last.class=="Thioalkalivibrio sp. ALBR X2")]<- "Thioalkalivibrio sp. ALBR_X2"
tabla_new$last.class[which(tabla_new$last.class=="Thioalkalivibrio sp. ALBR X3")]<- "Thioalkalivibrio sp. ALBR_X3"
tabla_new$last.class[which(tabla_new$last.class=="Thioalkalivibrio sp. ASLr1")] <- "Thioalkalivibrio sp."
tabla_new$last.class[which(tabla_new$last.class=="Thioalkalivibrio sp.")] <- "Thioalkalivibrio"
tabla_new$last.class[which(tabla_new$last.class=="Thiobacterales")] <- "Betaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Thiohalorhabdaceae")] <- "Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Thiohalorhabdales")] <- "Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="[Tissierellaceae]")] <- "Tissierellaceae"
tabla_new$last.class[which(tabla_new$last.class=="Tissierella_Soehngenia")] <- "Tissierella"
tabla_new$last.class[which(tabla_new$last.class=="TK06")] <- "Acidimicrobiales"
tabla_new$last.class[which(tabla_new$last.class=="TK10")] <- "Chloroflexi"
tabla_new$last.class[which(tabla_new$last.class=="TK17")] <- "Chloroflexi"
tabla_new$last.class[which(tabla_new$last.class=="TM1")] <- "Acidobacteria"
tabla_new$last.class[which(tabla_new$last.class=="TM214")] <- "Acidimicrobiales"
tabla_new$last.class[which(tabla_new$last.class=="TM6")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="TM7")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="TM7_genera_incertae_sedis")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Tolumonas sp. OCF7")] <- "Tolumonas"
tabla_new$last.class[which(tabla_new$last.class=="Trabulsiella farmeri")] <- "Trabulsiella"
tabla_new$last.class[which(tabla_new$last.class=="unclassified Alphaproteobacteria ")] <- "unclassified Alphaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="unclassified Bacteria ")] <- "unclassified Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="unclassified Bifidobacteriaceae")] <- "Bifidobacteriaceae"
tabla_new$last.class[which(tabla_new$last.class=="unclassified Gammaproteobacteria ")] <- "unclassified Gammaproteobacteria"
tabla_new$last.class[which(tabla_new$last.class=="unclassified Iamiaceae")] <- "Iamiaceae"
tabla_new$last.class[which(tabla_new$last.class=="unclassified Ktedobacteria")] <- "unclassified Ktedonobacteria"
tabla_new$last.class[which(tabla_new$last.class=="uncultured bacterium")]<- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="uncultured bacterium HF0010 09O16")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="uncultured nuHF2 cluster bacterium HF0770 42C12")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Unknown Eukaryote")] <- "Eukaryota"
tabla_new$last.class[which(tabla_new$last.class=="Unknown Metazoa")] <- "Eukaryota"
tabla_new$last.class[which(tabla_new$last.class=="VC2_1_Bac22")] <- "Bacteroidetes"
tabla_new$last.class[which(tabla_new$last.class=="VE39G03")] <- "Aeromonas"
tabla_new$last.class[which(tabla_new$last.class=="Verruco 5")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="Verruco-5")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="Vertebrata <Metazoa>")] <- "Metazoa"
tabla_new$last.class[which(tabla_new$last.class=="Vibrio parahaemolyticus 16")] <- "Vibrio parahaemolyticus"
tabla_new$last.class[which(tabla_new$last.class=="Vibrio sp. 27")]<- "Vibrio"
tabla_new$last.class[which(tabla_new$last.class=="Vibrio sp. TCBS 1")] <- "Vibrio sp."
tabla_new$last.class[which(tabla_new$last.class=="WCHB1-41")] <- "Verrucomicrobia"
tabla_new$last.class[which(tabla_new$last.class=="[Weeksellaceae]")] <- "Flavobacteriales"
tabla_new$last.class[which(tabla_new$last.class=="WM105")] <- "Caldithrix"
tabla_new$last.class[which(tabla_new$last.class=="WPS-2")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="WS3")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Xanthomonadaceae bacterium SAP40 3")]<- "Xanthomonadaceae bacterium SAP40_3"
tabla_new$last.class[which(tabla_new$last.class=="Xenococcus sp. CR 15M")]<- "Xenococcus sp. CR_15M"
tabla_new$last.class[which(tabla_new$last.class=="Xenococcus sp. CR L15")] <- "Xenococcus sp."
tabla_new$last.class[which(tabla_new$last.class=="Xenopus (Silurana) tropicalis (western clawed frog)")] <- "Xenopus tropicalis"
tabla_new$last.class[which(tabla_new$last.class=="YS2")] <- "Cyanobacteria"
tabla_new$last.class[which(tabla_new$last.class=="Z-35")] <- "Rhodocyclaceae"
tabla_new$last.class[which(tabla_new$last.class=="ZD0117")] <- "Alteromonadaceae"
tabla_new$last.class[which(tabla_new$last.class=="C6 d113")] <- "Planctomycetes"
tabla_new$last.class[which(tabla_new$last.class=="DH61")] <- "Planctomycetes"
tabla_new$last.class[which(tabla_new$last.class=="SR1")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Arctic95A-2")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="SL56")] <- "Chloroflexi"
tabla_new$last.class[which(tabla_new$last.class=="TM7-1")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="BSA2B-08")] <- "Clostridia"
tabla_new$last.class[which(tabla_new$last.class=="BS119")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="O4D2Z37")] <- "Anaerolineae"
tabla_new$last.class[which(tabla_new$last.class=="BA059")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="L7A E11")] <- "Erysipelotrichaceae"
tabla_new$last.class[which(tabla_new$last.class=="TSBW08")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="N09")] <- "Actinomycetaceae"
tabla_new$last.class[which(tabla_new$last.class=="A714017 so4B24")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Veillonellaceae vadinHB04")] <- "Veillonellaceae"
tabla_new$last.class[which(tabla_new$last.class=="[Fimbriimonadaceae]")] <- "Fimbriimonadaceae"
tabla_new$last.class[which(tabla_new$last.class=="E6")] <- "Synergistales"
tabla_new$last.class[which(tabla_new$last.class=="AK1AB1 02E")] <- "Gaiellales"
tabla_new$last.class[which(tabla_new$last.class=="YAB3B13")] <- "Natranaerobiales"
tabla_new$last.class[which(tabla_new$last.class=="S1198")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="OP2")] <- "Elusimicrobia"
tabla_new$last.class[which(tabla_new$last.class=="FBP")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="TSCOR003-O20")] <- "Fibrobacteres"
tabla_new$last.class[which(tabla_new$last.class=="MVS-107")] <- "Planctomycetes"
tabla_new$last.class[which(tabla_new$last.class=="CV106")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="LD19")] <- "Methylacidiphilales"
tabla_new$last.class[which(tabla_new$last.class=="C0119")] <- "Chloroflexi"
tabla_new$last.class[which(tabla_new$last.class=="AEGEAN 112")] <- "Rickettsiales"
tabla_new$last.class[which(tabla_new$last.class=="Natronincola Anaerovirgula")] <- "Clostridiaceae"
tabla_new$last.class[which(tabla_new$last.class=="A31")] <- "Anaerolineae"
tabla_new$last.class[which(tabla_new$last.class=="[Thermicanaceae]")] <- "Bacillales"
tabla_new$last.class[which(tabla_new$last.class=="SHAG537")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="CL0-1")] <- "Armatimonadaceae"
tabla_new$last.class[which(tabla_new$last.class=="DA101")] <- "Chthoniobacteraceae"
tabla_new$last.class[which(tabla_new$last.class=="VC21 Bac22")] <- "Bacteroidales"
tabla_new$last.class[which(tabla_new$last.class=="VC2 1 Bac22")] <- "Bacteroidetes"
tabla_new$last.class[which(tabla_new$last.class=="SargSea-WGS")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="A89")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="Acidimicrobiales ntu14")] <- "Acidimicrobiales"
tabla_new$last.class[which(tabla_new$last.class=="SJA-22")] <- "Chthonomonadetes"
tabla_new$last.class[which(tabla_new$last.class=="Sporomusa polytropa")] <- "Sporomusa"
tabla_new$last.class[which(tabla_new$last.class=="PK329")] <- "Chlorobi"
tabla_new$last.class[which(tabla_new$last.class=="SAW1 B6")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="WS1")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="OPB50")] <- "Armatimonadetes"
tabla_new$last.class[which(tabla_new$last.class=="SHAB590")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="P2-11E")] <- "Chloroflexi"
tabla_new$last.class[which(tabla_new$last.class=="MAT-CR-H3-D11")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="SJA-28")] <- "Chlorobi"
tabla_new$last.class[which(tabla_new$last.class=="Phycisphaerae mle1-8")] <- "Phycisphaerae"
tabla_new$last.class[which(tabla_new$last.class=="1-68")] <- "Tissierellaceae"
tabla_new$last.class[which(tabla_new$last.class=="AHT28")] <- "Firmicutes"
tabla_new$last.class[which(tabla_new$last.class=="BB34")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="SHA-1")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="BS11")] <- "Bacteroidales"
tabla_new$last.class[which(tabla_new$last.class=="At12OctB3")] <- "Bacteroidetes"
tabla_new$last.class[which(tabla_new$last.class=="A712011")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="[Brevinematales]")] <- "Brevinematales"
tabla_new$last.class[which(tabla_new$last.class=="GW-22")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="SC3")] <- "Bacteria"
tabla_new$last.class[which(tabla_new$last.class=="SGUS912")] <- "Amoebophilaceae"

write.table(tabla_new,"otus_unicos_mod.txt", quote=F, col.names=T, row.names=F, sep="\t")

system(paste("python ", directory_table2, sep=""))

tabla<- read.delim("otus_unicos_taxid_mod.txt")
colnames(tabla)[2]<-"taxid"
tabla$taxid_limpio<- sapply(as.character(tabla$taxid), function(x){strsplit(strsplit(as.character(x), "[[]")[[1]][2], "[]]")[[1]][1]})
tabla$last_class_clean <- sapply(as.character(tabla$last.class), function(x){strsplit(x, " ")[[1]][1]})

num2 <- grep("^[A-z]", tabla$taxid_limpio)
if(length(num2)>0){
	for (i in 1:length(num2)){
		num <- num2[i]
		taxid_sucio <- as.character(tabla$taxid[num])
		tabla$taxid_limpio[num] <- strsplit(strsplit(taxid_sucio, "[[]")[[1]][3], "[]]")[[1]][1]
	}
}

dobles <- read.delim(directory_table, header=T)

for (j in 1:dim(dobles)[1]){
	num <- which(tabla$last_class_clean==dobles$last_class[j])
	tabla$taxid_limpio[num] <-dobles$taxid[j]
}

new<- data.frame(tabla$reads_id, tabla$taxid_limpio, tabla$score)
write.table(new, "otu_ranking.txt", sep="\t", quote=F, col.names=F, row.names=F)